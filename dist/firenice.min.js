!function(i){var t={};function e(s){if(t[s])return t[s].exports;var h=t[s]={i:s,l:!1,exports:{}};return i[s].call(h.exports,h,h.exports,e),h.l=!0,h.exports}e.m=i,e.c=t,e.d=function(i,t,s){e.o(i,t)||Object.defineProperty(i,t,{enumerable:!0,get:s})},e.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},e.t=function(i,t){if(1&t&&(i=e(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.__esModule)return i;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var h in i)e.d(s,h,function(t){return i[t]}.bind(null,h));return s},e.n=function(i){var t=i&&i.__esModule?function(){return i.default}:function(){return i};return e.d(t,"a",t),t},e.o=function(i,t){return Object.prototype.hasOwnProperty.call(i,t)},e.p="",e(e.s=0)}([function(i,t,e){"use strict";e.r(t);const s=Object.freeze({TileWidth:32,MoveStand:0,MoveLeft:1,MoveRight:2,MoveDown:3,MoveUp:4,MoveTurn:5,MoveIceMake:6,MoveIceRemove:7,MoveIceMoving:8,MoveIceCheck:9,MoveRip:10,MovePush:8,MoveIceFail:11,MoveLevelExit:12,MoveLevelEnter:13,DirLeft:-1,DirRight:1,AnimDefaultDelay:2,AnimFrameCount:16,AnimLeftRow:1,AnimRightRow:0,AnimRunStart:0,AnimRunEnd:3,AnimStand:4,AnimTurnStart:4,AnimTurnEnd:7,AnimFallStart:8,AnimFallEnd:9,AnimBigFallStart:10,AnimBigFallEnd:11,AnimPushStart:12,AnimPushEnd:13,AnimJumpStart:14,AnimJumpEnd:15,AnimStandStart:16,AnimStandEnd:17,AnimIceStart:18,AnimIceEnd:19,AnimCrouchStart:20,AnimCrouchEnd:22,AnimRipStart:23,AnimRipEnd:24,AnimSleepStart:25,AnimSleepEnd:26,TileBackground:0,TileBothSides:32,TileLeftSide:64,TileMiddle:96,TileRightSide:128,ObjectOut:-1,ObjectBackground:0,ObjectWall:1,ObjectIce:3,ObjectMetal:4,ObjectJar:5,ObjectFire:6,ObjectPlayer:7,GameStatePlay:1,GameStateIntro:2});class h{constructor(){this.u=0,this.d=0,this.l=0,this.r=0,this.ul=0,this.ur=0,this.dl=0,this.dr=0}}class n{constructor(i,t){this.left=i,this.right=t}}class r{constructor(i,t,e,n,r,o){this.engine=t,this.id=i,this.ctx=t.ctx,this.corners=new h,this.solid=!0,this.moving=!1,this.counter=!1,this.speed=4,this.state=s.MoveStand,this.height=o,this.width=r,this.direction=0,this.xTile=e,this.yTile=n,this.x=this.xTile*s.TileWidth,this.y=this.yTile*s.TileWidth}setState(i,t){this.moving=void 0!==t&&t,this.state=i,this.counter=0}getTile(i,t){return this.engine.map.getTile(i,t)}isSpriteAt(i,t){return this.xTile===i&&this.yTile===t}spriteTypeAt(i,t){return this.engine.spriteTypeAt(i,t)}updateCorners(){this.corners.u=this.spriteTypeAt(this.xTile,this.yTile-1),this.corners.d=this.spriteTypeAt(this.xTile,this.yTile+1),this.corners.l=this.spriteTypeAt(this.xTile-1,this.yTile),this.corners.r=this.spriteTypeAt(this.xTile+1,this.yTile),this.corners.ul=this.spriteTypeAt(this.xTile-1,this.yTile-1),this.corners.ur=this.spriteTypeAt(this.xTile+1,this.yTile-1),this.corners.dl=this.spriteTypeAt(this.xTile-1,this.yTile+1),this.corners.dr=this.spriteTypeAt(this.xTile+1,this.yTile+1)}updatePosition(){this.xTile=Math.floor(this.x/s.TileWidth),this.yTile=Math.floor(this.y/s.TileWidth)}move(){}engineMove(){this.updateCorners(),this.move(),this.updatePosition()}}class o extends r{constructor(i,t,e,h,n,r,o,d,a,l,c,m){super(i,t,h,n,r,o),this.image=this.engine.resources.get(e),this.animLoop=m,this.animStart=l,this.animEnd=c,this.animCount=0,this.animDelay=s.AnimDefaultDelay,this.animDelayCount=0,this.animRow=0,this.offsetX=d,this.offsetY=a}setAnim(i,t,e,h,n,r){r=void 0!==r&&r,n=void 0===n?s.AnimDefaultDelay:n,h=void 0===h?this.animRow:h,r&&this.animStart===i&&this.animEnd===t&&this.animLoop===e&&this.animRow===h||(this.animStart=i,this.animEnd=t,this.animCount=i,this.animLoop=e,this.animDelay=n,this.animRow=h)}draw(){this.ctx.drawImage(this.image,this.animCount*this.width,this.animRow*this.height,this.width,this.height,this.x+this.offsetX,this.y+this.offsetY,this.width,this.height),this.animDelayCount++>this.animDelay&&(this.animCount+=1,this.animCount>this.animEnd&&(this.animLoop?this.animCount=this.animStart:this.animCount=this.animEnd),this.animDelayCount=0)}drawFrost(){const i=this.engine.spriteAt(this.xTile-1,this.yTile);i&&i.id===s.ObjectIce&&i.frozen.right&&this.ctx.drawImage(this.engine.resources.get("frost"),this.xTile*this.width-7,this.yTile*this.height);const t=this.engine.spriteAt(this.xTile+1,this.yTile);t&&t.id===s.ObjectIce&&t.frozen.left&&this.ctx.drawImage(this.engine.resources.get("frost"),(this.xTile+this.length)*this.width-7,this.yTile*this.height)}}const d=Object.freeze({tiles:{[s.ObjectBackground]:{solid:!1,freeze:!1},[s.ObjectOut]:{solid:!0,freeze:!1},[s.ObjectPlayer]:{solid:!0,freeze:!1},[s.ObjectIce]:{solid:!0,freeze:!1},[s.ObjectMetal]:{solid:!0,freeze:!0},[s.ObjectWall]:{solid:!0,freeze:!0},[s.ObjectFire]:{solid:!1,freeze:!1},[s.ObjectJar]:{solid:!0,freeze:!0}},isSolid:function(i){if(void 0===this.tiles[i])throw new Error("UNDEFINED ON isSolid");return this.tiles[i].solid},isFreezable:function(i){if(void 0===this.tiles[i])throw new Error("UNDEFINED ON isFreezable");return this.tiles[i].freeze}});class a extends o{constructor(i,t,e){super(s.ObjectFire,i,"img_fire",t,e,s.TileWidth,s.TileWidth,0,0,0,3,!0)}move(){switch(this.moving||(this.collisions(),this.gravity()),this.state){case s.MoveDown:this.doDown()}}collisions(){this.engine.spriteTypeAt(this.xTile,this.yTile,s.ObjectFire)===s.ObjectIce&&(this.engine.sound.play("fire-off"),this.engine.removeFire(this.xTile,this.yTile),this.engine.removeIceBlock(this.xTile,this.yTile),this.engine.addSparks(this.xTile,this.yTile,"255, 126, 198",15,.5),this.engine.addSparks(this.xTile,this.yTile,"124, 212, 255",10)),this.engine.spriteTypeAt(this.xTile,this.yTile,s.ObjectFire)===s.ObjectMetal&&(this.engine.sound.play("fire-off"),this.engine.removeFire(this.xTile,this.yTile),this.engine.addSparks(this.xTile,this.yTile,"255, 222, 127",15,.5),this.engine.addSparks(this.xTile,this.yTile,"41, 42, 90",10))}gravity(){return!d.isSolid(this.corners.d)&&this.corners.d!==s.ObjectFire&&(this.setState(s.MoveDown,!0),!0)}doDown(){this.counter+=4,this.counter<=s.TileWidth?this.y+=4:this.setState(s.MoveStand,!1)}}class l extends o{constructor(i,t,e,h,r){super(s.ObjectIce,i,"img_ice",t,e,s.TileWidth,s.TileWidth,0,0,0,1,!0),this.xTile=t,this.yTile=e,this.length=h,this.animEnd=1,this.animDelay=9,this.animRow=0,this.direction=0,this.falling=!1,void 0!==r?this.frozen=r:(this.frozen=new n(!1,!1),this.updateCorners(),this.checkFreeze())}addBlock(i){const t=this.engine.spriteTypeAt(i-1,this.yTile),e=this.engine.spriteTypeAt(this.xTile+this.length+1,this.yTile);i>this.xTile&&(this.getTile(i+1,this.yTile)!==s.ObjectWall&&e!==s.ObjectMetal&&e!==s.ObjectJar||(this.frozen.right=!0)),i<this.xTile&&(this.xTile=i,this.getTile(i-1,this.yTile)!==s.ObjectWall&&t!==s.ObjectMetal&&t!==s.ObjectJar||(this.frozen.left=!0)),this.x=this.xTile*s.TileWidth,this.length+=1}isSpriteAt(i,t){return this.yTile===t&&(i>=this.xTile&&i<this.xTile+this.length)}removeBlock(i){return i===this.xTile?(this.xTile+=1,this.x+=s.TileWidth,this.length-=1,this.checkUnfreezeLeft()):i===this.xTile+this.length-1?(this.length-=1,this.checkUnfreezeRight()):(this.engine.addSprite(new l(this.engine,i+1,this.yTile,this.xTile+this.length-i-1,new n(!1,this.frozen.right))),this.length=i-this.xTile,this.checkUnfreezeRight()),this.length}canGlide(i){return 1===this.length&&!this.frozen.left&&!this.frozen.right&&((i!==s.DirLeft||!d.isSolid(this.corners.l))&&(i!==s.DirRight||!d.isSolid(this.corners.r)))}isFrozen(){return this.frozen.left||this.frozen.right}gravity(){return d.isSolid(this.corners.d)||this.isFrozen()?(this.falling&&(this.falling=!1,this.engine.sound.play("ice-collision")),!1):(this.falling=!0,this.setState(s.MoveDown,!0),!0)}collision(){return!this.canGlide(this.direction)&&(this.direction=0,this.engine.sound.play("ice-collision"),!0)}move(){for(let i=0;i<this.length;i++){let t=this.spriteTypeAt(this.xTile+i,this.yTile+1);t&&t!==s.ObjectFire&&(this.corners.d=t)}switch(this.corners.r=this.spriteTypeAt(this.xTile+this.length,this.yTile),this.isFrozen()&&(this.checkUnfreezeLeft(),this.checkUnfreezeRight()),this.moving||this.gravity(),this.state){case s.MoveIceMoving:this.glide();break;case s.MoveIceCheck:this.push();break;case s.MoveDown:this.doDown()}}draw(){if(this.ctx.save(),this.animDelayCount++>this.animDelay&&(this.animDelayCount=0,this.animRow=0===this.animRow?1:0),1===this.length)this.ctx.drawImage(this.image,0,s.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height);else if(2===this.length)this.ctx.drawImage(this.image,s.TileWidth,s.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height),this.ctx.drawImage(this.image,3*s.TileWidth,s.TileWidth*this.animRow,this.width,this.height,this.x+s.TileWidth,this.y,this.width,this.height);else{this.ctx.drawImage(this.image,s.TileWidth,s.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height),this.ctx.drawImage(this.image,3*s.TileWidth,s.TileWidth*this.animRow,this.width,this.height,this.x+s.TileWidth*(this.length-1),this.y,this.width,this.height);for(let i=1;i<this.length-1;i++)this.ctx.drawImage(this.image,2*s.TileWidth,s.TileWidth*this.animRow,this.width,this.height,this.x+s.TileWidth*i,this.y,this.width,this.height)}this.frozen.left&&this.ctx.drawImage(this.engine.resources.get("frost"),this.xTile*this.width-7,this.yTile*this.height),this.frozen.right&&this.ctx.drawImage(this.engine.resources.get("frost"),(this.xTile+this.length)*this.width-7,this.yTile*this.height),this.ctx.restore()}glide(){this.counter+=4,this.counter<=s.TileWidth?this.x+=4*this.direction:this.push()}doDown(){this.counter+=4,this.counter<=s.TileWidth?this.y+=4:this.gravity()||this.setState(s.MoveStand,!1)}push(i){this.direction=void 0===i?this.direction:i,this.collision()||this.gravity()?this.setState(s.MoveStand,!1):this.setState(s.MoveIceMoving,!0)}checkFreeze(){d.isFreezable(this.corners.l)?this.frozen.left=!0:this.frozen.left=!1,d.isFreezable(this.corners.r)?this.frozen.right=!0:this.frozen.right=!1}checkUnfreezeLeft(){this.frozen.left&&!d.isFreezable(this.corners.l)&&(this.frozen.left=!1)}checkUnfreezeRight(){this.frozen.right&&!d.isFreezable(this.corners.r)&&(this.frozen.right=!1)}}class c{constructor(){this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.action=!1,this.keydown=this.keydown_.bind(this),this.keyup=this.keyup_.bind(this),this.intro=!0,window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1),document.getElementById("canvas").addEventListener("click",()=>{this.intro&&(this.enter=!0),this.intro=!1}),document.getElementById("btn_action").addEventListener("pointerdown",()=>{this.down=!0,this.left=!1,this.right=!1}),document.getElementById("btn_action").addEventListener("pointerup",()=>this.down=!1),document.getElementById("btn_left").addEventListener("pointerdown",()=>{this.left=!0,this.right=!1,this.down=!1}),document.getElementById("btn_left").addEventListener("pointerup",()=>this.left=!1),document.getElementById("btn_right").addEventListener("pointerdown",()=>{this.right=!0,this.left=!1,this.down=!1}),document.getElementById("btn_right").addEventListener("pointerup",()=>this.right=!1),document.getElementById("btn_select").addEventListener("click",()=>this.enter=!0)}keydown_(i){switch(i.preventDefault(),i.keyCode){case 37:this.left=!0,this.right=!1;break;case 38:this.up=!0;break;case 39:this.right=!0,this.left=!1;break;case 40:case 32:this.action=!0,this.left=!1,this.right=!1,this.down=!0;break;case 13:this.enter=!1}}keyup_(i){switch(i.preventDefault(),i.keyCode){case 37:this.left=!1;break;case 38:this.up=!1;break;case 39:this.right=!1;break;case 40:case 32:this.action=!1,this.down=!1;break;case 13:this.enter=!0}}}class m extends o{constructor(i,t,e){super(s.ObjectJar,i,"img_jar",t,e,s.TileWidth,s.TileWidth,0,0,0,3,!0),this.animDelay=2*s.AnimDefaultDelay,this.onFire=!1,this.animRow=0}move(){switch(this.moving||(this.collisions(),this.gravity()),this.state){case s.MoveDown:this.doDown()}}collisions(){this.onFire||this.corners.u!==s.ObjectFire||(this.turnOnFire(),this.engine.removeFire(this.xTile,this.yTile-1)),this.onFire&&this.corners.u===s.ObjectIce&&this.meltIce()}gravity(){return!this.corners.d&&(this.setState(s.MoveDown,!0),!0)}doDown(){this.counter+=4,this.counter<=s.TileWidth?this.y+=4:this.setState(s.MoveStand,!1)}turnOnFire(){this.animRow=1,this.onFire=!0,this.engine.sound.play("fire-off"),this.engine.addSparks(this.xTile,this.yTile-1,"255, 88, 33",30)}meltIce(){this.engine.removeIceBlock(this.xTile,this.yTile-1),this.engine.addSparks(this.xTile,this.yTile-1,"255, 88, 33",20),this.engine.addSparks(this.xTile,this.yTile-1,"122, 211, 255",10),this.engine.sound.play("fire-off")}draw(){super.draw(),this.drawFrost()}}class v extends o{constructor(i,t,e,h){super(s.ObjectMetal,i,"img_metal",t,e,s.TileWidth,s.TileWidth,0,0,0,1,!0),this.xTile=t,this.yTile=e,this.length=h,this.animDelay=9,this.direction=0,this.falling=!1}canGlide(i){return(i!==s.DirLeft||!d.isSolid(this.corners.l))&&(i!==s.DirRight||!d.isSolid(this.corners.r))}frozenToIce(){const i=this.engine.spriteAt(this.xTile+1,this.yTile),t=this.engine.spriteAt(this.xTile-1,this.yTile);return!this.falling&&(i&&i.id===s.ObjectIce&&i.frozen.left||t&&t.id===s.ObjectIce&&t.frozen.right)}gravity(){return d.isSolid(this.corners.d)||this.frozenToIce()?(this.falling&&(this.falling=!1,this.engine.sound.play("ice-collision")),!1):(this.falling=!0,this.setState(s.MoveDown,!0),!0)}collision(){return this.canGlide(this.direction)?!!this.gravity():(this.direction=0,this.engine.sound.play("ice-collision"),this.setState(s.MoveStand,!1),!0)}move(){switch(this.moving||this.gravity(),this.state){case s.MoveIceMoving:this.glide();break;case s.MoveIceCheck:this.push();break;case s.MoveDown:this.doDown()}}draw(){super.draw(),this.drawFrost()}glide(){this.counter+=4,this.counter<=s.TileWidth?this.x+=4*this.direction:this.setState(s.MoveStand,!1)}doDown(){this.counter+=4,this.counter<=s.TileWidth?this.y+=4:this.setState(s.MoveStand,!1)}push(i){this.direction=void 0===i?this.direction:i,this.collision()?this.setState(s.MoveStand,!1):(this.moving=!0,this.setState(s.MoveIceMoving,!0))}}class y extends o{constructor(i,t,e){super(s.ObjectPlayer,i,"img_dona",t,e,48,64,-10,-32,2,2,!1),this.speed=2,this.direction=1,this.state=0,this.moving=!1,this.tileWidth=s.TileWidth,this.tileHeight=s.TileWidth,this.animDelay=3,this.counter=0,this.fallCounter=0,this.innerCounter=0,this.standCounter=0,this.intro()}left(){this.moving||(this.direction!==s.DirLeft?(d.isSolid(this.corners.u)?this.setAnim(s.AnimCrouchStart,s.AnimCrouchStart,!1,s.AnimLeftRow,4):this.setAnim(s.AnimTurnStart,s.AnimTurnEnd,!1,s.AnimRightRow,4),this.setState(s.MoveTurn,!0),this.direction=s.DirLeft):(!d.isSolid(this.corners.l)&&d.isSolid(this.corners.d)&&(d.isSolid(this.corners.u)||d.isSolid(this.corners.ul)?this.setAnim(s.AnimCrouchStart,s.AnimCrouchEnd,!0,s.AnimLeftRow,2):this.setAnim(s.AnimRunStart,s.AnimRunEnd,!0,s.AnimLeftRow,2),this.setState(s.MoveLeft,!0)),!d.isSolid(this.corners.d)||this.corners.l!==s.ObjectIce&&this.corners.l!==s.ObjectMetal||this.push(),!d.isSolid(this.corners.l)||!d.isSolid(this.corners.d)||d.isSolid(this.corners.u)||d.isSolid(this.corners.ul)||this.moving||(this.setAnim(s.AnimPushStart,s.AnimPushStart,!1,s.AnimLeftRow),this.setState(s.MoveUp,!0))))}right(){this.moving||(this.direction!==s.DirRight?(d.isSolid(this.corners.u)?this.setAnim(s.AnimCrouchStart,s.AnimCrouchStart,!1,s.AnimRightRow,4):this.setAnim(s.AnimTurnStart,s.AnimTurnEnd,!1,s.AnimLeftRow,4),this.setState(s.MoveTurn,!0),this.direction=s.DirRight):(!d.isSolid(this.corners.r)&&d.isSolid(this.corners.d)&&(d.isSolid(this.corners.u)||d.isSolid(this.corners.ur)?this.setAnim(s.AnimCrouchStart,s.AnimCrouchEnd,!0,s.AnimRightRow,2):this.setAnim(s.AnimRunStart,s.AnimRunEnd,!0,s.AnimRightRow,2),this.setState(s.MoveRight,!0)),!d.isSolid(this.corners.d)||this.corners.r!==s.ObjectIce&&this.corners.r!==s.ObjectMetal||this.push(),!d.isSolid(this.corners.r)||!d.isSolid(this.corners.d)||d.isSolid(this.corners.u)||d.isSolid(this.corners.ur)||this.moving||(this.setAnim(s.AnimPushStart,s.AnimPushStart,!1,s.AnimRightRow),this.setState(s.MoveUp,!0))))}burn(){this.state!==s.MoveRip&&(this.engine.sound.playOnce("danger"),this.setState(s.MoveRip,!0),this.setAnim(s.AnimRipStart,s.AnimRipEnd,!0,s.AnimRightRow))}intro(){this.setAnim(s.AnimBigFallStart,s.AnimBigFallEnd,!0,s.AnimRightRow,4),this.setState(s.MoveLevelEnter,!0)}outro(){this.setAnim(s.AnimFallStart,s.AnimBigFallEnd,!0,s.AnimRightRow,4),this.setState(s.MoveLevelExit,!0),this.innerCounter=0}doRip(){}gravity(){if(!this.moving)if(void 0===this.corners.d&&console.eror("undefined corner"),d.isSolid(this.corners.d)){if(this.engine.sound.stop("falling"),this.state===s.MoveDown&&(this.engine.sound.play("fall"),this.engine.addSparks(this.xTile,this.yTile,"124, 238, 66",10,.75),this.engine.addSparks(this.xTile,this.yTile+1,"122, 211, 255",5,1.25)),this.fallCounter=0,this.setState(s.MoveStand,!1),this.corners.d===s.ObjectJar){const i=this.engine.spriteAt(this.xTile,this.yTile+1);i&&i.onFire&&this.burn()}}else this.setState(s.MoveDown,!0),this.fallCounter>=1?(this.engine.sound.playOnce("falling"),this.setAnim(s.AnimBigFallStart,s.AnimBigFallEnd,!0,s.AnimRightRow,1)):this.setAnim(s.AnimBigFallStart,s.AnimBigFallEnd,!0,s.AnimRightRow,3)}ice(){this.moving||d.isSolid(this.corners.d)&&(this.direction===s.DirRight?d.isSolid(this.corners.dr)||this.corners.dr===s.ObjectFire?this.corners.dr===s.ObjectIce?(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimRightRow,4),this.setState(s.MoveIceRemove,!0)):(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimRightRow,4),this.setState(s.MoveIceFail,!0)):(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimRightRow,4),this.setState(s.MoveIceMake,!0)):d.isSolid(this.corners.dl)||this.corners.dl===s.ObjectFire?this.corners.dl===s.ObjectIce?(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimLeftRow,4),this.setState(s.MoveIceRemove,!0)):(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimLeftRow,4),this.setState(s.MoveIceFail,!0)):(this.setAnim(s.AnimIceStart,s.AnimIceEnd,!1,s.AnimLeftRow,4),this.setState(s.MoveIceMake,!0)))}jump(){this.moving||(this.direction===s.DirRight?!d.isSolid(this.corners.r)||d.isSolid(this.corners.ur)||d.isSolid(this.corners.u)||(this.setAnim(s.AnimPushStart,s.AnimPushStart,!1,s.AnimRightRow),this.setState(s.MoveUp,!0)):!d.isSolid(this.corners.l)||d.isSolid(this.corners.ul)||d.isSolid(this.corners.u)||(this.setAnim(s.AnimPushStart,s.AnimPushStart,!1,s.AnimLeftRow),this.setState(s.MoveUp,!0)))}doRun(){this.counter+=1,this.counter<=s.AnimFrameCount?this.x+=this.speed*this.direction:this.setState(s.MoveStand,!1)}doTurn(){this.counter+=1,this.counter>=s.AnimFrameCount&&this.setState(s.MoveStand,!1)}doOutro(){this.counter+=1,this.counter%10==0&&(this.innerCounter+=1,1===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,"124, 238, 66",25,.5),3===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,"255, 135, 124",30,1),5===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,"122, 211, 255",35,1.5),this.innerCounter%2==0&&this.innerCounter<6&&this.engine.sound.play("climb")),this.innerCounter%2==1?this.y+=1:this.y-=1,this.innerCounter>=6&&(this.engine.sound.play("state-leave"),this.setState(s.MoveStand,!1),this.engine.nextLevel())}doIntro(){this.counter+=1,8===this.counter&&(this.engine.addSparks(this.xTile,this.yTile,"124, 238, 66",20,2.5),this.engine.addSparks(this.xTile,this.yTile,"255, 135, 124",35,1),this.engine.addSparks(this.xTile,this.yTile,"122, 211, 255",20,1.5),this.engine.sound.play("stage-enter")),this.counter>=32&&(this.engine.sound.stop("falling"),this.setState(s.MoveStand,!1))}doGravity(){this.counter+=1,this.counter<=s.AnimFrameCount?this.y+=this.speed:(this.moving=!1,this.gravity(),this.fallCounter++)}doStand(){d.isSolid(this.corners.u)?this.setAnim(s.AnimCrouchStart,s.AnimCrouchStart,!1,1!==this.direction?s.AnimLeftRow:s.AnimRightRow,8,!0):this.standCounter++>500?this.setAnim(s.AnimSleepStart,s.AnimSleepEnd,!0,1!==this.direction?s.AnimLeftRow:s.AnimRightRow,48,!0):this.setAnim(s.AnimStandStart,s.AnimStandEnd,!0,1!==this.direction?s.AnimLeftRow:s.AnimRightRow,8,!0)}doUp(){if(this.counter+=1,this.counter<=18)switch(this.counter){case 3:this.engine.sound.play("climb"),this.engine.addSparks(this.xTile,this.yTile,"124, 238, 66",10,.75),this.engine.addSparks(this.xTile,this.yTile,"255, 135, 124",5,1.25),this.setAnim(s.AnimPushEnd,s.AnimPushEnd,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow);break;case 6:this.setAnim(s.AnimJumpStart,s.AnimJumpStart,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 9:this.setAnim(s.AnimJumpEnd,s.AnimJumpEnd,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 12:this.setAnim(2,2,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 18:this.setAnim(s.AnimStand,s.AnimStand,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow),this.x+=8*this.direction,this.y-=8}else this.setState(s.MoveStand,!1)}makeIce(){this.engine.sound.play("new-ice"),this.engine.addIceBlock(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,"124, 214, 255",5)}removeIceBlock(){this.engine.sound.play("ice-remove"),this.engine.removeIceBlock(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,"124, 214, 255",5)}push(){let i=this.engine.iceAt(this.xTile+this.direction,this.yTile);i&&i.canGlide(this.direction)&&(this.engine.addSparks(this.xTile+this.direction,this.yTile,"255, 255, 255",3),this.engine.addSparks(this.xTile+this.direction,this.yTile,"124, 214, 255",3,1.5),this.setAnim(s.AnimPushStart,s.AnimPushEnd,!1,this.direction===s.DirRight?s.AnimRightRow:s.AnimLeftRow,3),this.setState(s.MovePush,!0))}doPush(){if(this.counter+=2,this.counter>s.AnimFrameCount){const i=this.engine.iceAt(this.xTile+this.direction,this.yTile);i&&(this.engine.sound.play("ice-push"),i.push(this.direction)),this.setState(s.MoveStand,!1)}}doIce(){8===this.counter&&(this.state===s.MoveIceMake?this.makeIce():this.removeIceBlock()),this.counter+=1,this.counter>=s.AnimFrameCount&&this.setState(s.MoveStand,!1)}doFailIce(){8===this.counter&&(this.engine.sound.play("ice-disabled"),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,"88,66,66")),this.counter+=1,this.counter>=s.AnimFrameCount&&this.setState(s.MoveStand,!1)}collisions(){this.engine.spriteTypeAt(this.xTile,this.yTile,s.ObjectPlayer)===s.ObjectFire&&this.burn()}move(){switch(this.gravity(),this.collisions(),this.state!==s.MoveStand&&(this.standCounter=0),this.state!==s.MoveDown&&(this.fallCounter=0),this.state){case s.MoveRight:case s.MoveLeft:this.doRun();break;case s.MoveDown:this.doGravity();break;case s.MoveUp:this.doUp();break;case s.MoveTurn:this.doTurn();break;case s.MoveIceMake:case s.MoveIceRemove:this.doIce();break;case s.MoveIceFail:this.doFailIce();break;case s.MoveStand:this.doStand();break;case s.MovePush:this.doPush();break;case s.MoveRip:this.doRip();break;case s.MoveLevelExit:this.doOutro();break;case s.MoveLevelEnter:this.doIntro()}}}class g{constructor(i,t,e){this.ctx=i.ctx,this.engine=i,this.map=t,this.theme=e,this.tileWidth=s.TileWidth,this.tileHeight=s.TileWidth,this.height=this.map.length-1,this.width=this.map[0].length-1,this.tilesImage=this.engine.resources.get("tilemap")}getTile(i,t){return i<0||t<0||i>this.width||t>this.height?s.ObjectOut:this.map[t][i]}draw(){this.ctx.save();for(let i=0;i<=this.width;++i)for(let t=0;t<=this.height;++t){let e=s.TileBackground;1===this.map[t][i]&&(e=this.getTile(i-1,t)||this.getTile(i+1,t)?this.getTile(i-1,t)?this.getTile(i+1,t)?s.TileMiddle:s.TileRightSide:s.TileLeftSide:s.TileBothSides),this.ctx.drawImage(this.tilesImage,e,this.theme*this.tileHeight,this.tileWidth,this.tileHeight,i*this.tileWidth,t*this.tileHeight,this.tileWidth,this.tileHeight)}this.ctx.restore()}move(){}engineMove(){}}const x=[{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:11,y:4,v:1},{id:3,x:5,y:9,v:1},{id:3,x:5,y:8,v:1},{id:3,x:5,y:7,v:1},{id:3,x:5,y:6,v:1},{id:6,x:6,y:4,v:1},{id:3,x:8,y:4,v:1},{id:6,x:7,y:9,v:1},{id:6,x:7,y:8,v:1},{id:6,x:7,y:7,v:1},{id:6,x:9,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:3,y:7,v:1},{id:6,x:6,y:7,v:1},{id:3,x:4,y:7,v:1},{id:3,x:10,y:5,v:4},{id:6,x:12,y:8,v:1},{id:6,x:12,y:7,v:1},{id:6,x:12,y:6,v:1},{id:6,x:13,y:8,v:1},{id:3,x:11,y:8,v:1},{id:3,x:11,y:7,v:1},{id:3,x:11,y:6,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:14,y:6,v:1},{id:6,x:10,y:9,v:1},{id:3,x:5,y:4,v:1},{id:6,x:9,y:6,v:1},{id:6,x:9,y:5,v:1},{id:3,x:11,y:6,v:1},{id:3,x:11,y:5,v:1},{id:3,x:8,y:6,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:8,y:9,v:1},{id:6,x:12,y:8,v:1},{id:6,x:13,y:7,v:1},{id:6,x:11,y:9,v:1},{id:3,x:6,y:8,v:5},{id:3,x:10,y:9,v:1},{id:3,x:10,y:7,v:3},{id:3,x:12,y:6,v:2},{id:3,x:6,y:9,v:1},{id:3,x:4,y:7,v:3},{id:3,x:3,y:6,v:2},{id:6,x:5,y:9,v:1},{id:6,x:4,y:8,v:1},{id:6,x:3,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:11,y:8,v:1},{id:3,x:10,y:10,v:3},{id:3,x:10,y:9,v:3},{id:3,x:7,y:7,v:1},{id:3,x:3,y:5,v:1},{id:3,x:9,y:7,v:1},{id:6,x:3,y:10,v:1},{id:3,x:3,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:5,sprites:[{id:7,x:13,y:3,v:1},{id:3,x:3,y:4,v:1,fl:!1,fr:!1},{id:3,x:6,y:6,v:1,fl:!1,fr:!1},{id:3,x:8,y:6,v:1,fl:!1,fr:!1},{id:3,x:10,y:6,v:1,fl:!1,fr:!1},{id:3,x:2,y:8,v:13,fl:!0,fr:!1},{id:6,x:2,y:7,v:1},{id:6,x:3,y:10,v:1},{id:6,x:4,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:10,v:1},{id:6,x:10,y:10,v:1},{id:6,x:11,y:10,v:1},{id:6,x:12,y:10,v:1},{id:6,x:13,y:10,v:1},{id:6,x:14,y:10,v:1},{id:3,x:14,y:4,v:1,fl:!0,fr:!0},{id:3,x:2,y:5,v:1,fl:!0,fr:!0}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:12,y:4,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:11,v:1},{id:6,x:10,y:11,v:1},{id:3,x:8,y:5,v:5},{id:3,x:10,y:4,v:1},{id:3,x:6,y:6,v:1},{id:6,x:6,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:8,y:6,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:10,v:1},{id:6,x:10,y:10,v:1},{id:3,x:11,y:10,v:2},{id:3,x:5,y:9,v:7},{id:6,x:5,y:8,v:1},{id:3,x:11,y:6,v:1},{id:6,x:11,y:5,v:1},{id:3,x:6,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:5,y:4,v:1},{id:6,x:5,y:8,v:1},{id:3,x:8,y:5,v:1},{id:3,x:8,y:4,v:1},{id:6,x:11,y:8,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:10,sprites:[{id:7,x:3,y:4,v:1},{id:6,x:2,y:6,v:1},{id:6,x:3,y:7,v:1},{id:6,x:4,y:8,v:1},{id:6,x:5,y:9,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:9,v:1},{id:6,x:9,y:8,v:1},{id:6,x:10,y:7,v:1},{id:6,x:11,y:6,v:1},{id:3,x:2,y:5,v:10},{id:3,x:5,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,1,1],[1,1,1,0,0,0,0,0,0,1,0,0,1,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,0,0,1,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:3,y:3,v:1},{id:6,x:13,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:3,x:4,y:4,v:1},{id:3,x:6,y:3,v:2},{id:3,x:11,y:3,v:2},{id:6,x:9,y:3,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:7,sprites:[{id:7,x:8,y:5,v:1},{id:6,x:6,y:5,v:1},{id:3,x:10,y:5,v:1},{id:3,x:2,y:3,v:2},{id:3,x:14,y:4,v:1},{id:3,x:14,y:4,v:1},{id:3,x:13,y:3,v:1},{id:6,x:14,y:3,v:1},{id:6,x:11,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:12,y:9,v:1},{id:6,x:2,y:9,v:1},{id:6,x:6,y:9,v:1},{id:6,x:7,y:9,v:1},{id:6,x:8,y:9,v:1},{id:6,x:9,y:9,v:1},{id:6,x:10,y:9,v:1},{id:6,x:13,y:9,v:1},{id:3,x:3,y:9,v:1},{id:3,x:3,y:8,v:11},{id:6,x:4,y:9,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:12,y:3,v:1},{id:4,x:10,y:3,v:1},{id:6,x:7,y:3,v:1},{id:6,x:10,y:7,v:1},{id:6,x:8,y:10,v:1},{id:4,x:7,y:7,v:1},{id:4,x:10,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:5,sprites:[{id:7,x:2,y:3,v:1},{id:6,x:4,y:3,v:1},{id:6,x:5,y:3,v:1},{id:4,x:3,y:3,v:1},{id:6,x:14,y:10,v:1},{id:6,x:13,y:10,v:1},{id:6,x:11,y:10,v:1},{id:6,x:12,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:8,y:4,v:1},{id:5,x:6,y:11,v:1},{id:6,x:5,y:9,v:1},{id:6,x:8,y:10,v:1},{id:4,x:7,y:4,v:1}]},{map:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],theme:1,sprites:[{id:7,x:10,y:6,v:1},{id:3,fl:!1,fr:!1,x:10,y:10,v:1},{id:3,fl:!1,fr:!1,x:6,y:9,v:5},{id:3,fl:!1,fr:!1,x:7,y:8,v:1},{id:3,fl:!1,fr:!1,x:6,y:7,v:5},{id:3,fl:!1,fr:!1,x:6,y:5,v:5},{id:6,x:6,y:10,v:1},{id:6,x:10,y:8,v:1},{id:6,x:6,y:6,v:1},{id:6,x:10,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:7,sprites:[{id:3,x:11,y:7,v:1,fl:!0,fr:!0},{id:3,x:9,y:7,v:1,fl:!0,fr:!0},{id:4,x:10,y:7,v:1},{id:6,x:10,y:8,v:1},{id:6,x:4,y:8,v:1},{id:7,x:7,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,0,1],[1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,0,1],[1,0,1,1,1,1,0,0,1,1,0,1,1,1,1,0,1],[1,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,1],[1,0,1,1,0,1,0,0,0,0,1,0,0,0,1,0,1],[1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1],[1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:4,y:4,v:1},{id:6,x:13,y:7,v:1},{id:4,x:7,y:8,v:1},{id:6,x:3,y:8,v:1},{id:3,x:6,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:8,y:8,v:1},{id:6,x:5,y:8,v:1},{id:3,x:5,y:7,v:3,fl:!0,fr:!1},{id:3,x:7,y:8,v:1,fl:!1,fr:!1},{id:6,x:10,y:6,v:1},{id:3,x:6,y:6,v:1,fl:!1,fr:!1},{id:3,x:6,y:5,v:3,fl:!1,fr:!1},{id:3,x:9,y:5,v:1,fl:!1,fr:!1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:6,y:4,v:1},{id:6,x:8,y:5,v:1},{id:6,x:9,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,1,0,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,1,1,0,1,0,1,1,1],[1,1,1,0,1,1,1,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:9,sprites:[{id:7,x:4,y:3,v:1},{id:3,x:6,y:4,v:1,fl:!0,fr:!0},{id:3,x:8,y:4,v:1,fl:!0,fr:!0},{id:3,x:10,y:4,v:4,fl:!0,fr:!0},{id:6,x:8,y:3,v:1},{id:4,x:11,y:9,v:1},{id:4,x:5,y:9,v:1},{id:6,x:3,y:9,v:1},{id:6,x:13,y:9,v:1},{id:5,x:8,y:10,v:!1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:10,y:5,v:1},{id:3,x:7,y:6,v:4,fl:!0,fr:!0},{id:6,x:7,y:5,v:1},{id:6,x:8,y:5,v:1},{id:6,x:9,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,0,0,0,1,1,1,0,0,1],[1,0,0,1,1,1,1,0,0,0,0,1,1,1,0,0,1],[1,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1],[1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:8,y:5,v:1},{id:5,x:6,y:10,v:!0},{id:5,x:5,y:7,v:!0},{id:5,x:8,y:8,v:!0},{id:6,x:5,y:6,v:1},{id:6,x:6,y:9,v:1},{id:6,x:8,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,0,1,1,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,1,1,1,0,1,1,1,0,1,1],[1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,1],[1,1,0,1,0,0,1,1,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:4,sprites:[{id:7,x:8,y:7,v:1},{id:3,x:6,y:6,v:1,fl:!1,fr:!0},{id:3,x:4,y:7,v:1,fl:!0,fr:!1},{id:3,x:4,y:5,v:1,fl:!0,fr:!1},{id:6,x:6,y:9,v:1},{id:6,x:9,y:9,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,1,1],[1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:9,y:11,v:1},{id:5,x:10,y:8,v:!0},{id:6,x:14,y:11,v:1},{id:4,x:11,y:2,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1],[1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,1,1,0,0,1,1,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:8,sprites:[{id:7,x:12,y:4,v:1},{id:5,x:11,y:7,v:!0},{id:4,x:10,y:6,v:1},{id:6,x:9,y:10,v:1},{id:6,x:11,y:6,v:1},{id:6,x:9,y:6,v:1},{id:6,x:14,y:6,v:1},{id:3,x:9,y:5,v:4,fl:!0,fr:!1},{id:3,x:9,y:4,v:1,fl:!1,fr:!1}]},{map:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0],[0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],theme:8,sprites:[{id:7,x:3,y:1,v:1},{id:4,x:4,y:2,v:1},{id:4,x:2,y:2,v:1},{id:3,x:3,y:2,v:1,fl:!0,fr:!0},{id:6,x:4,y:3,v:1},{id:6,x:2,y:3,v:1},{id:4,x:6,y:5,v:1},{id:3,x:7,y:5,v:1,fl:!0,fr:!1},{id:3,x:5,y:5,v:1,fl:!1,fr:!0},{id:4,x:4,y:8,v:1},{id:4,x:2,y:8,v:1},{id:3,x:3,y:8,v:1,fl:!0,fr:!0},{id:6,x:4,y:9,v:1},{id:6,x:2,y:9,v:1},{id:6,x:7,y:6,v:1},{id:6,x:5,y:6,v:1},{id:4,x:10,y:8,v:1},{id:4,x:8,y:8,v:1},{id:3,x:9,y:8,v:1,fl:!0,fr:!0},{id:6,x:9,y:9,v:1},{id:4,x:12,y:5,v:1},{id:3,x:13,y:5,v:1,fl:!0,fr:!1},{id:3,x:11,y:5,v:1,fl:!1,fr:!0},{id:6,x:12,y:6,v:1},{id:6,x:9,y:3,v:1},{id:4,x:10,y:2,v:1},{id:4,x:8,y:2,v:1},{id:3,x:9,y:2,v:1,fl:!0,fr:!0}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,0,0,0,0,0,0,0,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],sprites:[{id:7,x:13,y:2,v:1},{id:3,x:4,y:4,v:8},{id:3,x:11,y:3,v:4},{id:6,x:3,y:5,v:1},{id:6,x:4,y:6,v:1},{id:6,x:5,y:7,v:1},{id:6,x:10,y:6,v:1},{id:6,x:11,y:5,v:1},{id:6,x:14,y:10,v:1},{id:6,x:14,y:9,v:1},{id:6,x:2,y:10,v:1},{id:6,x:9,y:8,v:1},{id:6,x:2,y:9,v:1},{id:6,x:8,y:8,v:1},{id:6,x:7,y:8,v:1},{id:6,x:6,y:8,v:1},{id:6,x:8,y:10,v:1},{id:6,x:7,y:10,v:1}],theme:8},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:14,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,1,1,0,0,1,0,1,1,0,0,1,1],[1,1,0,1,0,0,1,1,0,1,0,1,0,1,0,1,1],[1,1,0,1,1,0,1,1,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,1,0,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,1],[1,1,0,1,1,0,1,0,0,1,1,1,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:9,sprites:[{id:7,x:10,y:11,v:1},{id:6,x:8,y:1,v:1},{id:5,x:4,y:11,v:1},{id:6,x:8,y:5,v:1}]}];class u{constructor(i){this.engine=i}save(){let i={};i.map=this.engine.map.map,i.theme=this.engine.map.theme,i.sprites=[];for(const t of this.engine.sprites){let e,h,n=void 0===t.length?1:t.length;n=t.id===s.ObjectJar?t.onFire:n,t.id===s.ObjectIce&&(e=t.frozen.left,h=t.frozen.right),i.sprites.push({id:t.id,x:t.xTile,y:t.yTile,v:n,fl:e,fr:h})}return i}load(i){void 0===x[i]&&(i=0),this.engine.level=i;const t=x[i];this.engine.sprites=[],this.engine.map=new g(this.engine,t.map,t.theme);for(const i of t.sprites)switch(i.id){case s.ObjectPlayer:this.engine.player=new y(this.engine,i.x,i.y),this.engine.addSprite(this.engine.player);break;case s.ObjectIce:let t=new n(!0,!0);void 0!==i.fl&&(t.left=i.fl,t.right=i.fr),this.engine.addSprite(new l(this.engine,i.x,i.y,parseInt(i.v),t));break;case s.ObjectMetal:this.engine.addSprite(new v(this.engine,i.x,i.y,1));break;case s.ObjectFire:this.engine.addSprite(new a(this.engine,i.x,i.y));break;case s.ObjectJar:const e=new m(this.engine,i.x,i.y);1==i.v&&e.turnOnFire(),this.engine.addSprite(e)}}}class f{constructor(i){this.resources=i,this.musicOn=!0,this.soundOn=!0,this.sfxVolume=.3,this.sfx={"fire-off":i.get("sfx-fire-off"),"ice-push":i.get("sfx-ice-push"),fall:i.get("sfx-fall"),falling:i.get("sfx-falling"),"new-ice":i.get("sfx-new-ice"),climb:i.get("sfx-climb"),"ice-collision":i.get("sfx-ice-collision"),"stage-enter":i.get("sfx-stage-enter"),danger:i.get("sfx-danger"),"ice-remove":i.get("sfx-ice-remove"),"state-leave":i.get("sfx-state-leave"),"ice-disabled":i.get("sfx-disabled")}}play(i){this.soundOn&&(this.sfx[i].volume=this.sfxVolume,this.sfx[i].currentTime=0,this.sfx[i].play().catch(()=>{}))}playOnce(i){this.sfx[i].paused&&this.soundOn&&(this.sfx[i].volume=this.sfxVolume,this.sfx[i].currentTime=0,this.sfx[i].play().catch(()=>{}))}stop(i){this.sfx[i].pause(),this.sfx[i].currentTime=0}soundtrack(){this.musicOn&&(this.music=this.resources.get("sfx-music-sparks"),this.music.muted=!1,this.music.volume=.2,this.music.loop=!0,this.music.play().catch(()=>{}))}}class p{constructor(i,t,e,s,h){this.color=void 0===s?"255,255,255":s,this.r=3,this.x=t,this.y=e,this.vx=(4*Math.random()-2)*h,this.vy=(6*Math.random()-4)*h,this.speed=.15,this.life=255,this.ctx=i}draw(){const i=this.life/255;this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.color+","+i+")",this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()}move(){this.x+=this.vx,this.y+=this.vy,this.vy+=this.speed,this.life-=5}}class T extends r{constructor(i,t,e,h,n,r){super(null,i,t,e,32,32),this.color=void 0===h?"255,255,255":h,this.length=void 0===n?10:n,this.intensity=void 0===r?1:r,this.particles=[];for(let i=0;i<this.length;i++)this.particles[i]=new p(this.engine.ctx,t*s.TileWidth+16,e*s.TileWidth+16,this.color,this.intensity)}draw(){this.engine.ctx.save();for(let i=0;i<this.particles.length;i++)this.particles[i].draw();this.engine.ctx.restore()}engineMove(){this.move()}move(){for(let i=0;i<this.particles.length;i++)this.particles[i].move(),this.particles[i].life<0&&this.particles.splice(i,1);this.particles.length||this.removeSelf()}removeSelf(){for(let i=0;i<this.engine.sfxs.length;i++)this.engine.sfxs[i]===this&&this.engine.sfxs.splice(i,1)}}class S{constructor(i,t){this.canvas=i,this.cwidth=i.width,this.cheight=i.height,this.resources=t,this.ctx=this.canvas.getContext("2d"),this.sprites=[],this.sfxs=[],this.player={},this.level=0,this.keyboard=new c,this.sound=new f(t),this.scene=new u(this),this.editor=!1,this.noSpriteMoveCount=0;const e=localStorage.getItem("level");null!==e&&(this.level=parseInt(e,10)),this.scene.load(this.level)}draw(){this.ctx.clearRect(0,0,this.cwidth,this.cheight),this.map.draw();for(let i=this.sprites.length-1;i>=0;i--)this.sprites[i].draw();for(let i=0;i<this.sfxs.length;++i)this.sfxs[i].draw();if(this.editor){this.ctx.strokeStyle="rgba(255,255,255,0.5)",this.ctx.strokeWidth=1,this.ctx.beginPath();for(let i=0;i<this.cwidth;i+=32)for(let t=0;t<this.cheight;t+=32)this.ctx.strokeRect(i,t,i+32,t+32);this.ctx.closePath()}}collision(){this.sprites.filter(i=>i.id===s.ObjectFire).length||this.editor||this.player.state===s.MoveLevelExit||this.player.outro()}nextLevel(){this.level++,localStorage.setItem("level",this.level),this.scene.load(this.level)}move(){for(let i=0;i<this.sprites.length;++i)this.sprites[i].engineMove();for(let i=0;i<this.sfxs.length;++i)this.sfxs[i].engineMove();let i=!1;for(let t=0;t<this.sprites.length;++t)this.sprites[t]&&this.sprites[t].id!==s.ObjectPlayer&&this.sprites[t].moving&&(i=!0);i?this.noSpriteMoveCount=0:this.noSpriteMoveCount+=1,!i&&this.noSpriteMoveCount>1&&(this.noSpriteMoveCount=0,this.input()),this.collision()}input(){(this.keyboard.down||this.keyboard.action)&&this.player.ice(),this.keyboard.left&&this.player.left(),this.keyboard.right&&this.player.right(),this.keyboard.enter&&(this.sound.stop("danger"),this.scene.load(this.level),this.keyboard.enter=!1)}iceAt(i,t){for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].isSpriteAt(i,t))return this.sprites[e];return!1}addIceBlock(i,t){let e=[];for(let h=0;h<this.sprites.length;h++)if(this.sprites[h].id===s.ObjectIce&&this.sprites[h].yTile===t){let t=this.sprites[h];t.xTile-1!==i&&t.xTile+t.length!==i||e.push(t)}0===e.length?this.sprites.push(new l(this,i,t,1)):1===e.length?e[0].addBlock(i):e[0].xTile<=e[1].xTile?this.joinIceBlocks(e[0],e[1]):this.joinIceBlocks(e[1],e[0])}joinIceBlocks(i,t){let e=i.xTile,s=i.yTile,h=i.length+t.length+1;this.addSprite(new l(this,e,s,h,new n(i.frozen.left,t.frozen.right))),this.removeSprite(i),this.removeSprite(t)}removeIceBlock(i,t){for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].id===s.ObjectIce&&this.sprites[e].yTile===t&&i>=this.sprites[e].xTile&&i<this.sprites[e].xTile+this.sprites[e].length)return void(this.sprites[e].removeBlock(i)<=0&&this.sprites.splice(e,1))}removeFire(i,t){for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].yTile===t&&i===this.sprites[e].xTile&&this.sprites[e].id===s.ObjectFire)return void this.sprites.splice(e,1)}addSprite(i){this.sprites.push(i)}removeSprite(i){for(let t=0;t<this.sprites.length;t++)if(this.sprites[t]===i)return this.sprites.splice(t,1),!0;return!1}addSparks(i,t,e,s,h){this.sfxs.push(new T(this,i,t,e,s,h))}spriteTypeAt(i,t,e){if(e=void 0===e?s.ObjectOut:e,i<0||t<0||i>this.map.width||t>this.map.height)return s.ObjectOut;if(this.map.map[t][i])return this.map.map[t][i];for(let s=0;s<this.sprites.length;s++)if(this.sprites[s].isSpriteAt(i,t)&&this.sprites[s].id!==e)return this.sprites[s].id;return s.ObjectBackground}spriteAt(i,t){if(!this.map.map[t][i])for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].isSpriteAt(i,t))return this.sprites[e];return null}}class w{constructor(i,t){this.engine=new S(i,t),this.levels=x,this.state=s.GameStatePlay,this.engine.sound.soundtrack(),this.gameLoop=this.gameLoop_.bind(this),this.gameLoop()}gameLoop_(){switch(this.state){case s.GameStateIntro:this.doIntro();break;case s.GameStatePlay:this.engine.draw(),this.engine.move()}window.requestAnimationFrame(this.gameLoop)}createIntro(){this.intro=new o(null,this.engine,"img_intro",0,0,544,416,0,0,0,0,!1),this.start=new o(null,this.engine,"img_start",7,11,140,26,-10,0,0,1,!0),this.start.animDelay=20*s.AnimDefaultDelay}doIntro(){this.intro.draw(),this.start.draw(),this.engine.keyboard.enter&&(this.engine.keyboard.enter=!1,this.state=s.GameStatePlay,this.engine.sound.soundtrack())}}class A{constructor(){this.definitions=[],this.resources={},this.loaded=0,this.canvas=document.getElementById("canvas"),canvas&&(this.ctx=this.canvas.getContext("2d"))}add(i,t,e){this.definitions.push({type:i,name:t,src:e})}get(i){return this.resources[i]}check(i){this.ctx&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#fff",this.ctx.fillRect(50,250,450*this.loaded/this.definitions.length,40)),this.loaded===this.definitions.length&&i()}ready(i){for(const t of this.definitions){if("image"===t.type){const e=new Image;e.addEventListener("load",()=>{this.loaded+=1,this.check(i)}),e.src=t.src,this.resources[t.name]=e}if("audio"===t.type){const e=document.getElementById(t.name);this.loaded+=1,this.resources[t.name]=e,this.check(i)}}}}function b(i){let t=i.target.getAttribute("lvl");game.engine.level=parseInt(t,10),game.engine.scene.load(game.engine.level)}window.addEventListener("load",()=>{const i=document.getElementById("loader");i.addEventListener("click",()=>{i.style.display="none",i.style.opacity=0,function(){const i=new A;i.add("image","tilemap","images/tilemap.png"),i.add("image","img_ice","images/ice.png"),i.add("image","img_jar","images/jar.png"),i.add("image","img_fire","images/fire.png"),i.add("image","img_dona","images/dona.png"),i.add("image","img_intro","images/intro.png"),i.add("image","img_metal","images/metal.png"),i.add("image","frost","images/frozen.png"),i.add("audio","sfx-ice-push","sounds/sfx-ice-push.mp3"),i.add("audio","sfx-fire-off","sounds/sfx-fire-off.mp3"),i.add("audio","sfx-falling","sounds/sfx-falling.mp3"),i.add("audio","sfx-new-ice","sounds/sfx-new-ice.mp3"),i.add("audio","sfx-climb","sounds/sfx-climb.mp3"),i.add("audio","sfx-ice-collision","sounds/sfx-ice-collision.mp3"),i.add("audio","sfx-stage-enter","sounds/sfx-stage-enter.mp3"),i.add("audio","sfx-danger","sounds/sfx-danger.mp3"),i.add("audio","sfx-ice-remove","sounds/sfx-ice-remove.mp3"),i.add("audio","sfx-state-leave","sounds/sfx-state-leave.mp3"),i.add("audio","sfx-disabled","sounds/sfx-disabled.mp3"),i.add("audio","sfx-fall","sounds/sfx-fall.mp3"),i.add("audio","sfx-music-sparks","music/sparks.mp3"),i.ready(()=>{!function(i){let t=document.getElementById("canvas"),e=new w(t,i);window.game=e,document.querySelectorAll("button.lvl").forEach(i=>{i.addEventListener("click",b)}),document.getElementById("level-selector").style.opacity=1}(i),window.FIRENICE_EDITOR_MODE&&(game.engine.sound.musicOn=!1,game.engine.sound.soundOn=!1,game.state=s.GameStatePlay,game.engine.editor=!0,game.engine.keyboard.intro=!1,game.engine.sound.music.pause(),canvas.addEventListener("click",i=>{const t=Math.floor(i.offsetX/32),e=Math.floor(i.offsetY/32);if(tool<2)game.engine.map.map[e][t]=tool;else switch(tool){case s.ObjectPlayer:game.engine.player.x=32*t,game.engine.player.y=32*e;break;case s.ObjectIce:game.engine.addIceBlock(t,e);break;case s.ObjectMetal:game.engine.addSprite(new v(game.engine,t,e,1));break;case s.ObjectFire:game.engine.addSprite(new a(game.engine,t,e));break;case s.ObjectJar:game.engine.addSprite(new m(game.engine,t,e))}}),document.getElementById("theme-selector").addEventListener("change",i=>{game.engine.map.theme=parseInt(i.target.value,10),i.target.blur()}),document.getElementById("btn-save").addEventListener("click",()=>{document.getElementById("txt-level").value=JSON.stringify(game.engine.scene.save())}))})}(),window.firenice=!0})})}]);