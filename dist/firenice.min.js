(()=>{"use strict";const i=Object.freeze({TileWidth:32,MoveStand:0,MoveLeft:1,MoveRight:2,MoveDown:3,MoveUp:4,MoveTurn:5,MoveIceMake:6,MoveIceRemove:7,MoveIceMoving:8,MoveIceCheck:9,MoveRip:10,MovePush:8,MoveIceFail:11,MoveLevelExit:12,MoveLevelEnter:13,MoveTeleportOut:14,MoveTeleportIn:15,DirLeft:-1,DirRight:1,AnimDefaultDelay:2,AnimFrameCount:16,AnimLeftRow:1,AnimRightRow:0,AnimRunStart:0,AnimRunEnd:3,AnimStand:4,AnimTurnStart:4,AnimTurnEnd:7,AnimFallStart:8,AnimFallEnd:9,AnimBigFallStart:10,AnimBigFallEnd:11,AnimPushStart:12,AnimPushEnd:13,AnimJumpStart:14,AnimJumpEnd:15,AnimStandStart:16,AnimStandEnd:17,AnimIceStart:18,AnimIceEnd:19,AnimCrouchStart:20,AnimCrouchEnd:22,AnimRipStart:23,AnimRipEnd:24,AnimSleepStart:25,AnimSleepEnd:26,TileBackground:0,TileBothSides:32,TileLeftSide:64,TileMiddle:96,TileRightSide:128,ObjectOut:-1,ObjectBackground:0,ObjectWall:1,ObjectIce:3,ObjectMetal:4,ObjectJar:5,ObjectFire:6,ObjectPlayer:7,ObjectTeleport:8,GameStatePlay:1,GameStateIntro:2,ColorGreen:"124, 238, 66",ColorBlue:"122, 211, 255",ColorOrange:"255, 88, 33",ColorRed:"255, 135, 124",ColorWhite:"255, 255, 255"});class t{constructor(){this.u=0,this.d=0,this.l=0,this.r=0,this.ul=0,this.ur=0,this.dl=0,this.dr=0}}class e{constructor(i,t){this.left=i,this.right=t}}class s{constructor(e,s,h,n,r,o){this.engine=s,this.id=e,this.ctx=s.ctx,this.corners=new t,this.solid=!0,this.moving=!1,this.counter=!1,this.speed=4,this.state=i.MoveStand,this.height=o,this.width=r,this.direction=0,this.xTile=h,this.yTile=n,this.x=this.xTile*i.TileWidth,this.y=this.yTile*i.TileWidth}setState(i,t){this.moving=void 0!==t&&t,this.state=i,this.counter=0}getTile(i,t){return this.engine.map.getTile(i,t)}isSpriteAt(i,t){return this.xTile===i&&this.yTile===t}spriteTypeAt(i,t){return this.engine.spriteTypeAt(i,t)}updateCorners(){this.corners.u=this.spriteTypeAt(this.xTile,this.yTile-1),this.corners.d=this.spriteTypeAt(this.xTile,this.yTile+1),this.corners.l=this.spriteTypeAt(this.xTile-1,this.yTile),this.corners.r=this.spriteTypeAt(this.xTile+1,this.yTile),this.corners.ul=this.spriteTypeAt(this.xTile-1,this.yTile-1),this.corners.ur=this.spriteTypeAt(this.xTile+1,this.yTile-1),this.corners.dl=this.spriteTypeAt(this.xTile-1,this.yTile+1),this.corners.dr=this.spriteTypeAt(this.xTile+1,this.yTile+1)}updatePosition(){this.xTile=Math.floor(this.x/i.TileWidth),this.yTile=Math.floor(this.y/i.TileWidth)}move(){}engineMove(){this.updateCorners(),this.move(),this.updatePosition()}}class h extends s{constructor(t,e,s,h,n,r,o,d,l,a,c,m){super(t,e,h,n,r,o),this.image=this.engine.resources.get(s),this.animLoop=m,this.animStart=a,this.animEnd=c,this.animCount=0,this.animDelay=i.AnimDefaultDelay,this.animDelayCount=0,this.animRow=0,this.offsetX=d,this.offsetY=l}setAnim(t,e,s,h,n,r){r=void 0!==r&&r,n=void 0===n?i.AnimDefaultDelay:n,h=void 0===h?this.animRow:h,r&&this.animStart===t&&this.animEnd===e&&this.animLoop===s&&this.animRow===h||(this.animStart=t,this.animEnd=e,this.animCount=t,this.animLoop=s,this.animDelay=n,this.animRow=h)}draw(){this.ctx.drawImage(this.image,this.animCount*this.width,this.animRow*this.height,this.width,this.height,this.x+this.offsetX,this.y+this.offsetY,this.width,this.height),this.animDelayCount++>this.animDelay&&(this.animCount+=1,this.animCount>this.animEnd&&(this.animLoop?this.animCount=this.animStart:this.animCount=this.animEnd),this.animDelayCount=0)}drawFrost(){const t=this.engine.spriteAt(this.xTile-1,this.yTile);t&&t.id===i.ObjectIce&&t.frozen.right&&this.ctx.drawImage(this.engine.resources.get("frost"),this.xTile*this.width-7,this.yTile*this.height);const e=this.engine.spriteAt(this.xTile+1,this.yTile);e&&e.id===i.ObjectIce&&e.frozen.left&&this.ctx.drawImage(this.engine.resources.get("frost"),(this.xTile+this.length)*this.width-7,this.yTile*this.height)}}const n=Object.freeze({tiles:{[i.ObjectBackground]:{solid:!1,freeze:!1},[i.ObjectOut]:{solid:!0,freeze:!1},[i.ObjectPlayer]:{solid:!0,freeze:!1},[i.ObjectIce]:{solid:!0,freeze:!1},[i.ObjectMetal]:{solid:!0,freeze:!0},[i.ObjectWall]:{solid:!0,freeze:!0},[i.ObjectFire]:{solid:!1,freeze:!1},[i.ObjectJar]:{solid:!0,freeze:!0},[i.ObjectTeleport]:{solid:!0,freeze:!0}},isSolid:function(i){if(void 0===this.tiles[i])throw new Error("UNDEFINED ON isSolid");return this.tiles[i].solid},isFreezable:function(i){if(void 0===this.tiles[i])throw new Error("UNDEFINED ON isFreezable");return this.tiles[i].freeze}});class r extends h{constructor(t,e,s){super(i.ObjectFire,t,"img_fire",e,s,i.TileWidth,i.TileWidth,0,0,0,3,!0)}move(){this.moving||(this.collisions(),this.gravity()),this.state===i.MoveDown&&this.doDown()}collisions(){this.engine.spriteTypeAt(this.xTile,this.yTile,i.ObjectFire)===i.ObjectIce&&(this.engine.sound.play("fire-off"),this.engine.removeFire(this.xTile,this.yTile),this.engine.removeIceBlock(this.xTile,this.yTile),this.engine.addSparks(this.xTile,this.yTile,"255, 126, 198",15,.5),this.engine.addSparks(this.xTile,this.yTile,"124, 212, 255",10)),this.engine.spriteTypeAt(this.xTile,this.yTile,i.ObjectFire)===i.ObjectMetal&&(this.engine.sound.play("fire-off"),this.engine.removeFire(this.xTile,this.yTile),this.engine.addSparks(this.xTile,this.yTile,"255, 222, 127",15,.5),this.engine.addSparks(this.xTile,this.yTile,"41, 42, 90",10))}gravity(){return!n.isSolid(this.corners.d)&&this.corners.d!==i.ObjectFire&&(this.setState(i.MoveDown,!0),!0)}doDown(){this.counter+=4,this.counter<=i.TileWidth?this.y+=4:this.setState(i.MoveStand,!1)}}class o extends h{constructor(t,s,h,n,r){super(i.ObjectIce,t,"img_ice",s,h,i.TileWidth,i.TileWidth,0,0,0,1,!0),this.xTile=s,this.yTile=h,this.length=n,this.animEnd=1,this.animDelay=9,this.animRow=0,this.direction=0,this.falling=!1,void 0!==r?this.frozen=r:(this.frozen=new e(!1,!1),this.updateCorners(),this.checkFreeze())}addBlock(t){const e=this.engine.spriteTypeAt(t-1,this.yTile),s=this.engine.spriteTypeAt(this.xTile+this.length+1,this.yTile);t>this.xTile&&(this.getTile(t+1,this.yTile)!==i.ObjectWall&&s!==i.ObjectMetal&&s!==i.ObjectJar||(this.frozen.right=!0)),t<this.xTile&&(this.xTile=t,this.getTile(t-1,this.yTile)!==i.ObjectWall&&e!==i.ObjectMetal&&e!==i.ObjectJar||(this.frozen.left=!0)),this.x=this.xTile*i.TileWidth,this.length+=1}isSpriteAt(i,t){return this.yTile===t&&i>=this.xTile&&i<this.xTile+this.length}removeBlock(t){return t===this.xTile?(this.xTile+=1,this.x+=i.TileWidth,this.length-=1,this.checkUnfreezeLeft()):t===this.xTile+this.length-1?(this.length-=1,this.checkUnfreezeRight()):(this.engine.addSprite(new o(this.engine,t+1,this.yTile,this.xTile+this.length-t-1,new e(!1,this.frozen.right))),this.length=t-this.xTile,this.checkUnfreezeRight()),this.length}canGlide(t){return!(1!==this.length||this.frozen.left||this.frozen.right||t===i.DirLeft&&n.isSolid(this.corners.l)||t===i.DirRight&&n.isSolid(this.corners.r))}isFrozen(){return this.frozen.left||this.frozen.right}gravity(){return n.isSolid(this.corners.d)||this.isFrozen()?(this.falling&&(this.falling=!1,this.engine.sound.play("ice-collision")),!1):(this.falling=!0,this.setState(i.MoveDown,!0),!0)}collision(){return!this.canGlide(this.direction)&&(this.direction=0,this.engine.sound.play("ice-collision"),!0)}move(){for(let t=0;t<this.length;t++){let e=this.spriteTypeAt(this.xTile+t,this.yTile+1);e&&e!==i.ObjectFire&&(this.corners.d=e)}switch(this.corners.r=this.spriteTypeAt(this.xTile+this.length,this.yTile),this.isFrozen()&&(this.checkUnfreezeLeft(),this.checkUnfreezeRight()),this.moving||this.gravity(),this.state){case i.MoveIceMoving:this.glide();break;case i.MoveIceCheck:this.push();break;case i.MoveDown:this.doDown()}}draw(){if(this.ctx.save(),this.animDelayCount++>this.animDelay&&(this.animDelayCount=0,this.animRow=0===this.animRow?1:0),1===this.length)this.ctx.drawImage(this.image,0,i.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height);else if(2===this.length)this.ctx.drawImage(this.image,i.TileWidth,i.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height),this.ctx.drawImage(this.image,3*i.TileWidth,i.TileWidth*this.animRow,this.width,this.height,this.x+i.TileWidth,this.y,this.width,this.height);else{this.ctx.drawImage(this.image,i.TileWidth,i.TileWidth*this.animRow,this.width,this.height,this.x,this.y,this.width,this.height),this.ctx.drawImage(this.image,3*i.TileWidth,i.TileWidth*this.animRow,this.width,this.height,this.x+i.TileWidth*(this.length-1),this.y,this.width,this.height);for(let t=1;t<this.length-1;t++)this.ctx.drawImage(this.image,2*i.TileWidth,i.TileWidth*this.animRow,this.width,this.height,this.x+i.TileWidth*t,this.y,this.width,this.height)}this.frozen.left&&this.ctx.drawImage(this.engine.resources.get("frost"),this.xTile*this.width-7,this.yTile*this.height),this.frozen.right&&this.ctx.drawImage(this.engine.resources.get("frost"),(this.xTile+this.length)*this.width-7,this.yTile*this.height),this.ctx.restore()}glide(){this.counter+=4,this.counter<=i.TileWidth?this.x+=4*this.direction:this.push()}doDown(){this.counter+=4,this.counter<=i.TileWidth?this.y+=4:this.gravity()||this.setState(i.MoveStand,!1)}push(t){this.direction=void 0===t?this.direction:t,this.collision()||this.gravity()?this.setState(i.MoveStand,!1):this.setState(i.MoveIceMoving,!0)}checkFreeze(){n.isFreezable(this.corners.l)?this.frozen.left=!0:this.frozen.left=!1,n.isFreezable(this.corners.r)?this.frozen.right=!0:this.frozen.right=!1}checkUnfreezeLeft(){this.frozen.left&&!n.isFreezable(this.corners.l)&&(this.frozen.left=!1)}checkUnfreezeRight(){this.frozen.right&&!n.isFreezable(this.corners.r)&&(this.frozen.right=!1)}}class d{constructor(){this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.action=!1,this.keydown=this.keydown_.bind(this),this.keyup=this.keyup_.bind(this),this.intro=!0,window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1),document.getElementById("canvas").addEventListener("click",(()=>{this.intro&&(this.enter=!0),this.intro=!1})),document.getElementById("btn_action").addEventListener("pointerdown",(()=>{this.down=!0,this.left=!1,this.right=!1})),document.getElementById("btn_action").addEventListener("pointerup",(()=>this.down=!1)),document.getElementById("btn_left").addEventListener("pointerdown",(()=>{this.left=!0,this.right=!1,this.down=!1})),document.getElementById("btn_left").addEventListener("pointerup",(()=>this.left=!1)),document.getElementById("btn_right").addEventListener("pointerdown",(()=>{this.right=!0,this.left=!1,this.down=!1})),document.getElementById("btn_right").addEventListener("pointerup",(()=>this.right=!1)),document.getElementById("btn_select").addEventListener("click",(()=>this.enter=!0))}keydown_(i){switch(i.preventDefault(),i.keyCode){case 37:this.left=!0,this.right=!1;break;case 38:this.up=!0;break;case 39:this.right=!0,this.left=!1;break;case 40:case 32:this.action=!0,this.left=!1,this.right=!1,this.down=!0;break;case 13:this.enter=!1}}keyup_(i){switch(i.preventDefault(),i.keyCode){case 37:this.left=!1;break;case 38:this.up=!1;break;case 39:this.right=!1;break;case 40:case 32:this.action=!1,this.down=!1;break;case 13:this.enter=!0}}}class l extends h{constructor(t,e,s){super(i.ObjectJar,t,"img_jar",e,s,i.TileWidth,i.TileWidth,0,0,0,3,!0),this.animDelay=2*i.AnimDefaultDelay,this.onFire=!1,this.animRow=0}move(){this.moving||(this.collisions(),this.gravity()),this.state===i.MoveDown&&this.doDown()}collisions(){this.onFire||this.corners.u!==i.ObjectFire||(this.turnOnFire(),this.engine.removeFire(this.xTile,this.yTile-1)),this.onFire&&this.corners.u===i.ObjectIce&&this.meltIce()}gravity(){return!this.corners.d&&(this.setState(i.MoveDown,!0),!0)}doDown(){this.counter+=4,this.counter<=i.TileWidth?this.y+=4:this.setState(i.MoveStand,!1)}turnOnFire(){this.animRow=1,this.onFire=!0,this.engine.sound.play("fire-off"),this.engine.addSparks(this.xTile,this.yTile-1,i.ColorOrange,30)}meltIce(){this.engine.removeIceBlock(this.xTile,this.yTile-1),this.engine.addSparks(this.xTile,this.yTile-1,i.ColorOrange,20),this.engine.addSparks(this.xTile,this.yTile-1,i.ColorBlue,10),this.engine.sound.play("fire-off")}draw(){super.draw(),this.drawFrost()}}class a extends h{constructor(t,e,s,h){super(i.ObjectMetal,t,"img_metal",e,s,i.TileWidth,i.TileWidth,0,0,0,1,!0),this.xTile=e,this.yTile=s,this.length=h,this.animDelay=9,this.direction=0,this.falling=!1}canGlide(t){return!(t===i.DirLeft&&n.isSolid(this.corners.l)||t===i.DirRight&&n.isSolid(this.corners.r))}frozenToIce(){const t=this.engine.spriteAt(this.xTile+1,this.yTile),e=this.engine.spriteAt(this.xTile-1,this.yTile);return!this.falling&&(t&&t.id===i.ObjectIce&&t.frozen.left||e&&e.id===i.ObjectIce&&e.frozen.right)}gravity(){return n.isSolid(this.corners.d)||this.frozenToIce()?(this.falling&&(this.falling=!1,this.engine.sound.play("ice-collision")),!1):(this.falling=!0,this.setState(i.MoveDown,!0),!0)}collision(){return this.canGlide(this.direction)?!!this.gravity():(this.direction=0,this.engine.sound.play("ice-collision"),this.setState(i.MoveStand,!1),!0)}move(){switch(this.moving||this.gravity(),this.state){case i.MoveIceMoving:this.glide();break;case i.MoveIceCheck:this.push();break;case i.MoveDown:this.doDown()}}draw(){super.draw(),this.drawFrost()}glide(){this.counter+=4,this.counter<=i.TileWidth?this.x+=4*this.direction:this.setState(i.MoveStand,!1)}doDown(){this.counter+=4,this.counter<=i.TileWidth?this.y+=4:this.setState(i.MoveStand,!1)}push(t){this.direction=void 0===t?this.direction:t,this.collision()?this.setState(i.MoveStand,!1):(this.moving=!0,this.setState(i.MoveIceMoving,!0))}}class c extends h{constructor(t,e,s){super(i.ObjectPlayer,t,"img_dona",e,s,48,64,-10,-32,2,2,!1),this.speed=2,this.direction=1,this.state=0,this.moving=!1,this.tileWidth=i.TileWidth,this.tileHeight=i.TileWidth,this.animDelay=3,this.counter=0,this.fallCounter=0,this.innerCounter=0,this.standCounter=0,this.intro()}left(){this.moving||(this.direction!==i.DirLeft?(n.isSolid(this.corners.u)?this.setAnim(i.AnimCrouchStart,i.AnimCrouchStart,!1,i.AnimLeftRow,4):this.setAnim(i.AnimTurnStart,i.AnimTurnEnd,!1,i.AnimRightRow,4),this.setState(i.MoveTurn,!0),this.direction=i.DirLeft):(!n.isSolid(this.corners.l)&&n.isSolid(this.corners.d)&&(n.isSolid(this.corners.u)||n.isSolid(this.corners.ul)?this.setAnim(i.AnimCrouchStart,i.AnimCrouchEnd,!0,i.AnimLeftRow,2):this.setAnim(i.AnimRunStart,i.AnimRunEnd,!0,i.AnimLeftRow,2),this.setState(i.MoveLeft,!0)),!n.isSolid(this.corners.d)||this.corners.l!==i.ObjectIce&&this.corners.l!==i.ObjectMetal||this.push(),!n.isSolid(this.corners.l)||!n.isSolid(this.corners.d)||n.isSolid(this.corners.u)||n.isSolid(this.corners.ul)||this.moving||(this.setAnim(i.AnimPushStart,i.AnimPushStart,!1,i.AnimLeftRow),this.setState(i.MoveUp,!0))))}right(){this.moving||(this.direction!==i.DirRight?(n.isSolid(this.corners.u)?this.setAnim(i.AnimCrouchStart,i.AnimCrouchStart,!1,i.AnimRightRow,4):this.setAnim(i.AnimTurnStart,i.AnimTurnEnd,!1,i.AnimLeftRow,4),this.setState(i.MoveTurn,!0),this.direction=i.DirRight):(!n.isSolid(this.corners.r)&&n.isSolid(this.corners.d)&&(n.isSolid(this.corners.u)||n.isSolid(this.corners.ur)?this.setAnim(i.AnimCrouchStart,i.AnimCrouchEnd,!0,i.AnimRightRow,2):this.setAnim(i.AnimRunStart,i.AnimRunEnd,!0,i.AnimRightRow,2),this.setState(i.MoveRight,!0)),!n.isSolid(this.corners.d)||this.corners.r!==i.ObjectIce&&this.corners.r!==i.ObjectMetal||this.push(),!n.isSolid(this.corners.r)||!n.isSolid(this.corners.d)||n.isSolid(this.corners.u)||n.isSolid(this.corners.ur)||this.moving||(this.setAnim(i.AnimPushStart,i.AnimPushStart,!1,i.AnimRightRow),this.setState(i.MoveUp,!0))))}burn(){this.state!==i.MoveRip&&(this.engine.sound.playOnce("danger"),this.counter=0,this.innerCounter=0,this.setState(i.MoveRip,!0),this.setAnim(i.AnimRipStart,i.AnimRipEnd,!0,i.AnimRightRow))}intro(){this.setAnim(i.AnimBigFallStart,i.AnimBigFallEnd,!0,i.AnimRightRow,4),this.setState(i.MoveLevelEnter,!0)}outro(){this.setAnim(i.AnimFallStart,i.AnimBigFallEnd,!0,i.AnimRightRow,4),this.setState(i.MoveLevelExit,!0),this.innerCounter=0}doRip(){this.counter+=1,this.counter%10==0&&(this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,5,1.2),this.engine.addSparks(this.xTile,this.yTile,i.ColorBlue,5,.7)),this.counter>=70&&(this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,15,2),this.engine.addSparks(this.xTile,this.yTile,i.ColorBlue,10,3),this.counter=0,this.engine.keyboard.enter=!0)}gravity(){if(!this.moving)if(void 0===this.corners.d&&console.error("undefined corner"),n.isSolid(this.corners.d)){if(this.engine.sound.stop("falling"),this.state===i.MoveDown&&(this.engine.sound.play("fall"),this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,10,.75),this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,5,1.25)),this.fallCounter=0,this.setState(i.MoveStand,!1),this.corners.d===i.ObjectJar){const i=this.engine.spriteAt(this.xTile,this.yTile+1);i&&i.onFire&&this.burn()}}else this.setState(i.MoveDown,!0),this.fallCounter>=1?(this.engine.sound.playOnce("falling"),this.setAnim(i.AnimBigFallStart,i.AnimBigFallEnd,!0,i.AnimRightRow,1)):this.setAnim(i.AnimBigFallStart,i.AnimBigFallEnd,!0,i.AnimRightRow,3)}iceOrTeleport(){this.moving||(this.corners.d===i.ObjectTeleport?this.teleport():this.ice())}teleport(){this.moving||(this.setAnim(i.AnimFallStart,i.AnimBigFallEnd,!0,i.AnimRightRow,4),this.setState(i.MoveTeleportOut,!0),this.innerCounter=0,this.doTeleportIn())}ice(){this.moving||n.isSolid(this.corners.d)&&(this.direction===i.DirRight?n.isSolid(this.corners.dr)||this.corners.dr===i.ObjectFire?this.corners.dr===i.ObjectIce?(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimRightRow,4),this.setState(i.MoveIceRemove,!0)):(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimRightRow,4),this.setState(i.MoveIceFail,!0)):(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimRightRow,4),this.setState(i.MoveIceMake,!0)):n.isSolid(this.corners.dl)||this.corners.dl===i.ObjectFire?this.corners.dl===i.ObjectIce?(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimLeftRow,4),this.setState(i.MoveIceRemove,!0)):(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimLeftRow,4),this.setState(i.MoveIceFail,!0)):(this.setAnim(i.AnimIceStart,i.AnimIceEnd,!1,i.AnimLeftRow,4),this.setState(i.MoveIceMake,!0)))}jump(){this.moving||(this.direction===i.DirRight?!n.isSolid(this.corners.r)||n.isSolid(this.corners.ur)||n.isSolid(this.corners.u)||(this.setAnim(i.AnimPushStart,i.AnimPushStart,!1,i.AnimRightRow),this.setState(i.MoveUp,!0)):!n.isSolid(this.corners.l)||n.isSolid(this.corners.ul)||n.isSolid(this.corners.u)||(this.setAnim(i.AnimPushStart,i.AnimPushStart,!1,i.AnimLeftRow),this.setState(i.MoveUp,!0)))}doRun(){this.counter+=1,this.counter<=i.AnimFrameCount?this.x+=this.speed*this.direction:this.setState(i.MoveStand,!1)}doTurn(){this.counter+=1,this.counter>=i.AnimFrameCount&&this.setState(i.MoveStand,!1)}doOutro(){this.counter+=1,this.counter%10==0&&(this.innerCounter+=1,1===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,25,.5),3===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,30,1),5===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,i.ColorBlue,35,1.5),this.innerCounter%2==0&&this.innerCounter<6&&this.engine.sound.play("climb")),this.innerCounter%2==1?this.y+=1:this.y-=1,this.innerCounter>=6&&(this.engine.sound.play("state-leave"),this.setState(i.MoveStand,!1),this.engine.nextLevel())}doIntro(){this.counter+=1,8===this.counter&&(this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,20,2.5),this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,35,1),this.engine.addSparks(this.xTile,this.yTile,i.ColorBlue,20,1.5),this.engine.sound.play("stage-enter")),this.counter>=32&&(this.engine.sound.stop("falling"),this.setState(i.MoveStand,!1))}doGravity(){this.counter+=1,this.counter<=i.AnimFrameCount?this.y+=this.speed:(this.moving=!1,this.gravity(),this.fallCounter++)}doStand(){n.isSolid(this.corners.u)?this.setAnim(i.AnimCrouchStart,i.AnimCrouchStart,!1,1!==this.direction?i.AnimLeftRow:i.AnimRightRow,8,!0):this.standCounter++>500?this.setAnim(i.AnimSleepStart,i.AnimSleepEnd,!0,1!==this.direction?i.AnimLeftRow:i.AnimRightRow,48,!0):this.setAnim(i.AnimStandStart,i.AnimStandEnd,!0,1!==this.direction?i.AnimLeftRow:i.AnimRightRow,8,!0)}doUp(){if(this.counter+=1,this.counter<=18)switch(this.counter){case 3:this.engine.sound.play("climb"),this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,10,.75),this.engine.addSparks(this.xTile,this.yTile,i.ColorRed,5,1.25),this.setAnim(i.AnimPushEnd,i.AnimPushEnd,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow);break;case 6:this.setAnim(i.AnimJumpStart,i.AnimJumpStart,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 9:this.setAnim(i.AnimJumpEnd,i.AnimJumpEnd,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 12:this.setAnim(2,2,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow),this.x+=8*this.direction,this.y-=8;break;case 18:this.setAnim(i.AnimStand,i.AnimStand,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow),this.x+=8*this.direction,this.y-=8}else this.setState(i.MoveStand,!1)}makeIce(){this.engine.sound.play("new-ice"),this.engine.addIceBlock(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,i.ColorBlue,5)}removeIceBlock(){this.engine.sound.play("ice-remove"),this.engine.removeIceBlock(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,i.ColorBlue,5)}push(){let t=this.engine.iceAt(this.xTile+this.direction,this.yTile);t&&t.canGlide(this.direction)&&(this.engine.addSparks(this.xTile+this.direction,this.yTile,i.ColorWhite,3),this.engine.addSparks(this.xTile+this.direction,this.yTile,i.ColorBlue,3,1.5),this.setAnim(i.AnimPushStart,i.AnimPushEnd,!1,this.direction===i.DirRight?i.AnimRightRow:i.AnimLeftRow,3),this.setState(i.MovePush,!0))}doPush(){if(this.counter+=2,this.counter>i.AnimFrameCount){const t=this.engine.iceAt(this.xTile+this.direction,this.yTile);t&&(this.engine.sound.play("ice-push"),t.push(this.direction)),this.setState(i.MoveStand,!1)}}doIce(){8===this.counter&&(this.state===i.MoveIceMake?this.makeIce():this.removeIceBlock()),this.counter+=1,this.counter>=i.AnimFrameCount&&this.setState(i.MoveStand,!1)}doFailIce(){8===this.counter&&(this.engine.sound.play("ice-disabled"),this.engine.addSparks(this.xTile+this.direction,this.yTile+1,"88,66,66")),this.counter+=1,this.counter>=i.AnimFrameCount&&this.setState(i.MoveStand,!1)}doTeleportIn(){this.counter+=1,this.counter%10==0&&(this.innerCounter+=1,1===this.innerCounter&&(this.engine.sound.play("climb"),this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,10,.5)),2===this.innerCounter&&this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,10,1.5)),this.innerCounter>=2&&this.doTeleportOut()}doTeleportOut(){const t=this.engine.spriteAt(this.xTile,this.yTile+1);this.x=t.link.x,this.y=t.link.y-32,this.updatePosition(),this.engine.addSparks(this.xTile,this.yTile,i.ColorGreen,15,1.5),this.engine.sound.play("ice-remove"),this.setState(i.MoveStand,!1)}collisions(){this.engine.spriteTypeAt(this.xTile,this.yTile,i.ObjectPlayer)===i.ObjectFire&&this.burn()}move(){switch(this.gravity(),this.collisions(),this.state!==i.MoveStand&&(this.standCounter=0),this.state!==i.MoveDown&&(this.fallCounter=0),this.state){case i.MoveRight:case i.MoveLeft:this.doRun();break;case i.MoveDown:this.doGravity();break;case i.MoveUp:this.doUp();break;case i.MoveTurn:this.doTurn();break;case i.MoveIceMake:case i.MoveIceRemove:this.doIce();break;case i.MoveIceFail:this.doFailIce();break;case i.MoveStand:this.doStand();break;case i.MovePush:this.doPush();break;case i.MoveRip:this.doRip();break;case i.MoveLevelExit:this.doOutro();break;case i.MoveTeleportOut:this.doTeleportIn();break;case i.MoveLevelEnter:this.doIntro()}}}class m{constructor(t,e,s){this.ctx=t.ctx,this.engine=t,this.map=e,this.theme=s,this.tileWidth=i.TileWidth,this.tileHeight=i.TileWidth,this.height=this.map.length-1,this.width=this.map[0].length-1,this.tilesImage=this.engine.resources.get("tilemap")}getTile(t,e){return t<0||e<0||t>this.width||e>this.height?i.ObjectOut:this.map[e][t]}draw(){this.ctx.save();for(let t=0;t<=this.width;++t)for(let e=0;e<=this.height;++e){let s=i.TileBackground;1===this.map[e][t]&&(s=this.getTile(t-1,e)||this.getTile(t+1,e)?this.getTile(t-1,e)?this.getTile(t+1,e)?i.TileMiddle:i.TileRightSide:i.TileLeftSide:i.TileBothSides),this.ctx.drawImage(this.tilesImage,s,this.theme*this.tileHeight,this.tileWidth,this.tileHeight,t*this.tileWidth,e*this.tileHeight,this.tileWidth,this.tileHeight)}this.ctx.restore()}move(){}engineMove(){}}const v=[{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:11,y:4,v:1},{id:3,x:5,y:9,v:1},{id:3,x:5,y:8,v:1},{id:3,x:5,y:7,v:1},{id:3,x:5,y:6,v:1},{id:6,x:6,y:4,v:1},{id:3,x:8,y:4,v:1},{id:6,x:7,y:9,v:1},{id:6,x:7,y:8,v:1},{id:6,x:7,y:7,v:1},{id:6,x:9,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:3,y:7,v:1},{id:6,x:6,y:7,v:1},{id:3,x:4,y:7,v:1},{id:3,x:10,y:5,v:4},{id:6,x:12,y:8,v:1},{id:6,x:12,y:7,v:1},{id:6,x:12,y:6,v:1},{id:6,x:13,y:8,v:1},{id:3,x:11,y:8,v:1},{id:3,x:11,y:7,v:1},{id:3,x:11,y:6,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:14,y:6,v:1},{id:6,x:10,y:9,v:1},{id:3,x:5,y:4,v:1},{id:6,x:9,y:6,v:1},{id:6,x:9,y:5,v:1},{id:3,x:11,y:6,v:1},{id:3,x:11,y:5,v:1},{id:3,x:8,y:6,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:8,y:9,v:1},{id:6,x:12,y:8,v:1},{id:6,x:13,y:7,v:1},{id:6,x:11,y:9,v:1},{id:3,x:6,y:8,v:5},{id:3,x:10,y:9,v:1},{id:3,x:10,y:7,v:3},{id:3,x:12,y:6,v:2},{id:3,x:6,y:9,v:1},{id:3,x:4,y:7,v:3},{id:3,x:3,y:6,v:2},{id:6,x:5,y:9,v:1},{id:6,x:4,y:8,v:1},{id:6,x:3,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:11,y:8,v:1},{id:3,x:10,y:10,v:3},{id:3,x:10,y:9,v:3},{id:3,x:7,y:7,v:1},{id:3,x:3,y:5,v:1},{id:3,x:9,y:7,v:1},{id:6,x:3,y:10,v:1},{id:3,x:3,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:5,sprites:[{id:7,x:13,y:3,v:1},{id:3,x:3,y:4,v:1,fl:!1,fr:!1},{id:3,x:6,y:6,v:1,fl:!1,fr:!1},{id:3,x:8,y:6,v:1,fl:!1,fr:!1},{id:3,x:10,y:6,v:1,fl:!1,fr:!1},{id:3,x:2,y:8,v:13,fl:!0,fr:!1},{id:6,x:2,y:7,v:1},{id:6,x:3,y:10,v:1},{id:6,x:4,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:10,v:1},{id:6,x:10,y:10,v:1},{id:6,x:11,y:10,v:1},{id:6,x:12,y:10,v:1},{id:6,x:13,y:10,v:1},{id:6,x:14,y:10,v:1},{id:3,x:14,y:4,v:1,fl:!0,fr:!0},{id:3,x:2,y:5,v:1,fl:!0,fr:!0}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:12,y:4,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:11,v:1},{id:6,x:10,y:11,v:1},{id:3,x:8,y:5,v:5},{id:3,x:10,y:4,v:1},{id:3,x:6,y:6,v:1},{id:6,x:6,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:8,y:6,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:10,v:1},{id:6,x:9,y:10,v:1},{id:6,x:10,y:10,v:1},{id:3,x:11,y:10,v:2},{id:3,x:5,y:9,v:7},{id:6,x:5,y:8,v:1},{id:3,x:11,y:6,v:1},{id:6,x:11,y:5,v:1},{id:3,x:6,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:5,y:4,v:1},{id:6,x:5,y:8,v:1},{id:3,x:8,y:5,v:1},{id:3,x:8,y:4,v:1},{id:6,x:11,y:8,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:10,sprites:[{id:7,x:3,y:4,v:1},{id:6,x:2,y:6,v:1},{id:6,x:3,y:7,v:1},{id:6,x:4,y:8,v:1},{id:6,x:5,y:9,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:6,x:8,y:9,v:1},{id:6,x:9,y:8,v:1},{id:6,x:10,y:7,v:1},{id:6,x:11,y:6,v:1},{id:3,x:2,y:5,v:10},{id:3,x:5,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,1,1],[1,1,1,0,0,0,0,0,0,1,0,0,1,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,0,0,1,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:3,y:3,v:1},{id:6,x:13,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:6,y:10,v:1},{id:6,x:7,y:10,v:1},{id:3,x:4,y:4,v:1},{id:3,x:6,y:3,v:2},{id:3,x:11,y:3,v:2},{id:6,x:9,y:3,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:7,sprites:[{id:7,x:8,y:5,v:1},{id:6,x:6,y:5,v:1},{id:3,x:10,y:5,v:1},{id:3,x:2,y:3,v:2},{id:3,x:14,y:4,v:1},{id:3,x:14,y:4,v:1},{id:3,x:13,y:3,v:1},{id:6,x:14,y:3,v:1},{id:6,x:11,y:10,v:1},{id:6,x:5,y:10,v:1},{id:6,x:12,y:9,v:1},{id:6,x:2,y:9,v:1},{id:6,x:6,y:9,v:1},{id:6,x:7,y:9,v:1},{id:6,x:8,y:9,v:1},{id:6,x:9,y:9,v:1},{id:6,x:10,y:9,v:1},{id:6,x:13,y:9,v:1},{id:3,x:3,y:9,v:1},{id:3,x:3,y:8,v:11},{id:6,x:4,y:9,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:12,y:3,v:1},{id:4,x:10,y:3,v:1},{id:6,x:7,y:3,v:1},{id:6,x:10,y:7,v:1},{id:6,x:8,y:10,v:1},{id:4,x:7,y:7,v:1},{id:4,x:10,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:5,sprites:[{id:7,x:2,y:3,v:1},{id:6,x:4,y:3,v:1},{id:6,x:5,y:3,v:1},{id:4,x:3,y:3,v:1},{id:6,x:14,y:10,v:1},{id:6,x:13,y:10,v:1},{id:6,x:11,y:10,v:1},{id:6,x:12,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:8,y:4,v:1},{id:5,x:6,y:11,v:1},{id:6,x:5,y:9,v:1},{id:6,x:8,y:10,v:1},{id:4,x:7,y:4,v:1}]},{map:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],theme:1,sprites:[{id:7,x:10,y:6,v:1},{id:3,fl:!1,fr:!1,x:10,y:10,v:1},{id:3,fl:!1,fr:!1,x:6,y:9,v:5},{id:3,fl:!1,fr:!1,x:7,y:8,v:1},{id:3,fl:!1,fr:!1,x:6,y:7,v:5},{id:3,fl:!1,fr:!1,x:6,y:5,v:5},{id:6,x:6,y:10,v:1},{id:6,x:10,y:8,v:1},{id:6,x:6,y:6,v:1},{id:6,x:10,y:4,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1,1],[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:7,sprites:[{id:3,x:11,y:7,v:1,fl:!0,fr:!0},{id:3,x:9,y:7,v:1,fl:!0,fr:!0},{id:4,x:10,y:7,v:1},{id:6,x:10,y:8,v:1},{id:6,x:4,y:8,v:1},{id:7,x:7,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,0,1],[1,0,1,1,0,0,0,0,1,1,0,0,0,1,1,0,1],[1,0,1,1,1,1,0,0,1,1,0,1,1,1,1,0,1],[1,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,1],[1,0,1,1,0,1,0,0,0,0,1,0,0,0,1,0,1],[1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1],[1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:4,y:4,v:1},{id:6,x:13,y:7,v:1},{id:4,x:7,y:8,v:1},{id:6,x:3,y:8,v:1},{id:3,x:6,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,0,0,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:1,sprites:[{id:7,x:8,y:8,v:1},{id:6,x:5,y:8,v:1},{id:3,x:5,y:7,v:3,fl:!0,fr:!1},{id:3,x:7,y:8,v:1,fl:!1,fr:!1},{id:6,x:10,y:6,v:1},{id:3,x:6,y:6,v:1,fl:!1,fr:!1},{id:3,x:6,y:5,v:3,fl:!1,fr:!1},{id:3,x:9,y:5,v:1,fl:!1,fr:!1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,1,1,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:2,sprites:[{id:7,x:6,y:4,v:1},{id:6,x:8,y:5,v:1},{id:6,x:9,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,1,0,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,1,1,0,0,0,1,1,0,1,0,1,1,1],[1,1,1,0,1,1,1,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:9,sprites:[{id:7,x:4,y:3,v:1},{id:3,x:6,y:4,v:1,fl:!0,fr:!0},{id:3,x:8,y:4,v:1,fl:!0,fr:!0},{id:3,x:10,y:4,v:4,fl:!0,fr:!0},{id:6,x:8,y:3,v:1},{id:4,x:11,y:9,v:1},{id:4,x:5,y:9,v:1},{id:6,x:3,y:9,v:1},{id:6,x:13,y:9,v:1},{id:5,x:8,y:10,v:!1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:10,y:5,v:1},{id:3,x:7,y:6,v:4,fl:!0,fr:!0},{id:6,x:7,y:5,v:1},{id:6,x:8,y:5,v:1},{id:6,x:9,y:5,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,1,1,0,0,0,1,1,1,0,0,1],[1,0,0,1,1,1,1,0,0,0,0,1,1,1,0,0,1],[1,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,0,0,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1],[1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1],[1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:0,sprites:[{id:7,x:8,y:5,v:1},{id:5,x:6,y:10,v:!0},{id:5,x:5,y:7,v:!0},{id:5,x:8,y:8,v:!0},{id:6,x:5,y:6,v:1},{id:6,x:6,y:9,v:1},{id:6,x:8,y:7,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,1,1],[1,1,0,1,1,0,0,0,0,0,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,0,1,1,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],[1,1,0,1,0,0,0,1,1,1,0,1,1,1,0,1,1],[1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,1],[1,1,0,1,0,0,1,1,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:4,sprites:[{id:7,x:8,y:7,v:1},{id:3,x:6,y:6,v:1,fl:!1,fr:!0},{id:3,x:4,y:7,v:1,fl:!0,fr:!1},{id:3,x:4,y:5,v:1,fl:!0,fr:!1},{id:6,x:6,y:9,v:1},{id:6,x:9,y:9,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,1,1],[1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:9,y:11,v:1},{id:5,x:10,y:8,v:!0},{id:6,x:14,y:11,v:1},{id:4,x:11,y:2,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1],[1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,1,1,1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,1,1,0,0,1,1,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:8,sprites:[{id:7,x:12,y:4,v:1},{id:5,x:11,y:7,v:!0},{id:4,x:10,y:6,v:1},{id:6,x:9,y:10,v:1},{id:6,x:11,y:6,v:1},{id:6,x:9,y:6,v:1},{id:6,x:14,y:6,v:1},{id:3,x:9,y:5,v:4,fl:!0,fr:!1},{id:3,x:9,y:4,v:1,fl:!1,fr:!1}]},{map:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0],[0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],theme:8,sprites:[{id:7,x:3,y:1,v:1},{id:4,x:4,y:2,v:1},{id:4,x:2,y:2,v:1},{id:3,x:3,y:2,v:1,fl:!0,fr:!0},{id:6,x:4,y:3,v:1},{id:6,x:2,y:3,v:1},{id:4,x:6,y:5,v:1},{id:3,x:7,y:5,v:1,fl:!0,fr:!1},{id:3,x:5,y:5,v:1,fl:!1,fr:!0},{id:4,x:4,y:8,v:1},{id:4,x:2,y:8,v:1},{id:3,x:3,y:8,v:1,fl:!0,fr:!0},{id:6,x:4,y:9,v:1},{id:6,x:2,y:9,v:1},{id:6,x:7,y:6,v:1},{id:6,x:5,y:6,v:1},{id:4,x:10,y:8,v:1},{id:4,x:8,y:8,v:1},{id:3,x:9,y:8,v:1,fl:!0,fr:!0},{id:6,x:9,y:9,v:1},{id:4,x:12,y:5,v:1},{id:3,x:13,y:5,v:1,fl:!0,fr:!1},{id:3,x:11,y:5,v:1,fl:!1,fr:!0},{id:6,x:12,y:6,v:1},{id:6,x:9,y:3,v:1},{id:4,x:10,y:2,v:1},{id:4,x:8,y:2,v:1},{id:3,x:9,y:2,v:1,fl:!0,fr:!0}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1],[1,1,0,1,0,0,0,0,0,0,0,1,1,1,0,1,1],[1,1,0,1,1,0,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,1],[1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],sprites:[{id:7,x:13,y:2,v:1},{id:3,x:4,y:4,v:8},{id:3,x:11,y:3,v:4},{id:6,x:3,y:5,v:1},{id:6,x:4,y:6,v:1},{id:6,x:5,y:7,v:1},{id:6,x:10,y:6,v:1},{id:6,x:11,y:5,v:1},{id:6,x:14,y:10,v:1},{id:6,x:14,y:9,v:1},{id:6,x:2,y:10,v:1},{id:6,x:9,y:8,v:1},{id:6,x:2,y:9,v:1},{id:6,x:8,y:8,v:1},{id:6,x:7,y:8,v:1},{id:6,x:6,y:8,v:1},{id:6,x:8,y:10,v:1},{id:6,x:7,y:10,v:1}],theme:8},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:14,y:10,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,1,1,0,1,1,0,0,0,0,1,1],[1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,1,1],[1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:6,sprites:[{id:7,x:10,y:7,v:1},{id:5,x:8,y:8,v:!0},{id:8,x:14,y:8,v:!1,ref:1,link:2},{id:8,x:8,y:4,v:!1,ref:2,link:1},{id:6,x:4,y:9,v:1}]},{map:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,1,1,1,1,0,0,1,0,1,1,0,0,1,1],[1,1,0,1,0,0,1,1,0,1,0,1,0,1,0,1,1],[1,1,0,1,1,0,1,1,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,1,0,1,1,0,1,0,1,0,1,1],[1,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,1],[1,1,0,1,1,0,1,0,0,1,1,1,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],theme:9,sprites:[{id:7,x:10,y:11,v:1},{id:6,x:8,y:1,v:1},{id:5,x:4,y:11,v:1},{id:6,x:8,y:5,v:1}]}];class y extends h{constructor(t,e,s){super(i.ObjectTeleport,t,"img_teleport",e,s,i.TileWidth,i.TileWidth,0,0,0,3,!0),this.isSolid=!0,this.animDelay=2*i.AnimDefaultDelay,this.onFire=!1,this.animRow=0}move(){this.moving||(this.collisions(),this.gravity()),this.state===i.MoveDown&&this.doDown()}collisions(){}gravity(){return!this.corners.d&&(this.setState(i.MoveDown,!0),!0)}doDown(){this.counter+=4,this.counter<=i.TileWidth?this.y+=4:this.setState(i.MoveStand,!1)}draw(){super.draw(),this.drawFrost()}}class g{constructor(i){this.engine=i}save(){let t={};t.map=this.engine.map.map,t.theme=this.engine.map.theme,t.sprites=[];for(const e of this.engine.sprites){let s,h,n=void 0===e.length?1:e.length;n=e.id===i.ObjectJar?e.onFire:n,e.id===i.ObjectIce&&(s=e.frozen.left,h=e.frozen.right),t.sprites.push({id:e.id,x:e.xTile,y:e.yTile,v:n,fl:s,fr:h})}return t}load(t){void 0===v[t]&&(t=0),this.engine.level=t;const s=v[t];this.engine.sprites=[],this.engine.map=new m(this.engine,s.map,s.theme);const h=new Map;for(const t of s.sprites)switch(t.id){case i.ObjectPlayer:this.engine.player=new c(this.engine,t.x,t.y),this.engine.addSprite(this.engine.player);break;case i.ObjectIce:let s=new e(!0,!0);void 0!==t.fl&&(s.left=t.fl,s.right=t.fr),this.engine.addSprite(new o(this.engine,t.x,t.y,parseInt(t.v),s));break;case i.ObjectMetal:this.engine.addSprite(new a(this.engine,t.x,t.y,1));break;case i.ObjectFire:this.engine.addSprite(new r(this.engine,t.x,t.y));break;case i.ObjectJar:const n=new l(this.engine,t.x,t.y);1==t.v&&n.turnOnFire(),this.engine.addSprite(n);break;case i.ObjectTeleport:const d=new y(this.engine,t.x,t.y);this.engine.addSprite(d),d.linkId=t.link,h.set(t.ref,d)}if(h.size)for(const i of h.values()){const t=h.get(i.linkId);t&&(i.link=t)}}}class x{constructor(i){this.resources=i,this.musicOn=!0,this.soundOn=!0,this.sfxVolume=.3,this.sfx={"fire-off":i.get("sfx-fire-off"),"ice-push":i.get("sfx-ice-push"),fall:i.get("sfx-fall"),falling:i.get("sfx-falling"),"new-ice":i.get("sfx-new-ice"),climb:i.get("sfx-climb"),"ice-collision":i.get("sfx-ice-collision"),"stage-enter":i.get("sfx-stage-enter"),danger:i.get("sfx-danger"),"ice-remove":i.get("sfx-ice-remove"),"state-leave":i.get("sfx-state-leave"),"ice-disabled":i.get("sfx-disabled")}}play(i){this.soundOn&&(this.sfx[i].volume=this.sfxVolume,this.sfx[i].currentTime=0,this.sfx[i].play().catch((()=>{})))}playOnce(i){this.sfx[i].paused&&this.soundOn&&(this.sfx[i].volume=this.sfxVolume,this.sfx[i].currentTime=0,this.sfx[i].play().catch((()=>{})))}stop(i){this.sfx[i].pause(),this.sfx[i].currentTime=0}soundtrack(){this.musicOn&&(this.music=this.resources.get("sfx-music-sparks"),this.music.muted=!1,this.music.volume=.2,this.music.loop=!0,this.music.play().catch((()=>{})))}}class u{constructor(t,e,s,h,n){this.color=void 0===h?i.ColorWhite:h,this.r=4,this.x=e,this.y=s,this.vx=(4*Math.random()-2)*n,this.vy=(6*Math.random()-4)*n,this.speed=.15,this.life=255,this.ctx=t}draw(){const i=this.life/255;this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.color+","+i+")",this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()}move(){this.x+=this.vx,this.y+=this.vy,this.vy+=this.speed,this.life-=5}}class p extends s{constructor(t,e,s,h,n,r){super(null,t,e,s,32,32),this.color=void 0===h?"255,255,255":h,this.length=void 0===n?10:n,this.intensity=void 0===r?1:r,this.particles=[];for(let t=0;t<this.length;t++)this.particles[t]=new u(this.engine.ctx,e*i.TileWidth+16,s*i.TileWidth+16,this.color,this.intensity)}draw(){this.engine.ctx.save();for(let i=0;i<this.particles.length;i++)this.particles[i].draw();this.engine.ctx.restore()}engineMove(){this.move()}move(){for(let i=0;i<this.particles.length;i++)this.particles[i].move(),this.particles[i].life<0&&this.particles.splice(i,1);this.particles.length||this.removeSelf()}removeSelf(){for(let i=0;i<this.engine.sfxs.length;i++)this.engine.sfxs[i]===this&&this.engine.sfxs.splice(i,1)}}class f{constructor(i,t){this.canvas=i,this.cwidth=i.width,this.cheight=i.height,this.resources=t,this.ctx=this.canvas.getContext("2d"),this.sprites=[],this.sfxs=[],this.player={},this.level=0,this.keyboard=new d,this.sound=new x(t),this.scene=new g(this),this.editor=!1,this.noSpriteMoveCount=0;const e=localStorage.getItem("level");null!==e&&(this.level=parseInt(e,10)),this.scene.load(this.level)}draw(){this.ctx.clearRect(0,0,this.cwidth,this.cheight),this.map.draw();for(let i=this.sprites.length-1;i>=0;i--)this.sprites[i].draw();for(let i=0;i<this.sfxs.length;++i)this.sfxs[i].draw();if(this.editor){this.ctx.strokeStyle="rgba(255,255,255,0.5)",this.ctx.strokeWidth=1,this.ctx.beginPath();for(let i=0;i<this.cwidth;i+=32)for(let t=0;t<this.cheight;t+=32)this.ctx.strokeRect(i,t,i+32,t+32);this.ctx.closePath()}}collision(){this.sprites.filter((t=>t.id===i.ObjectFire)).length||this.editor||this.player.state===i.MoveLevelExit||this.player.outro()}nextLevel(){this.level++,localStorage.setItem("level",this.level),this.scene.load(this.level)}move(){for(let i=0;i<this.sprites.length;++i)this.sprites[i].engineMove();for(let i=0;i<this.sfxs.length;++i)this.sfxs[i].engineMove();let t=!1;for(let e=0;e<this.sprites.length;++e)this.sprites[e]&&this.sprites[e].id!==i.ObjectPlayer&&this.sprites[e].moving&&(t=!0);t?this.noSpriteMoveCount=0:this.noSpriteMoveCount+=1,!t&&this.noSpriteMoveCount>1&&(this.noSpriteMoveCount=0,this.input()),this.collision()}input(){(this.keyboard.down||this.keyboard.action)&&this.player.iceOrTeleport(),this.keyboard.left&&this.player.left(),this.keyboard.right&&this.player.right(),this.keyboard.enter&&(this.sound.stop("danger"),this.scene.load(this.level),this.keyboard.enter=!1)}iceAt(i,t){for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].isSpriteAt(i,t))return this.sprites[e];return!1}addIceBlock(t,e){let s=[];for(let h=0;h<this.sprites.length;h++)if(this.sprites[h].id===i.ObjectIce&&this.sprites[h].yTile===e){let i=this.sprites[h];i.xTile-1!==t&&i.xTile+i.length!==t||s.push(i)}0===s.length?this.sprites.push(new o(this,t,e,1)):1===s.length?s[0].addBlock(t):s[0].xTile<=s[1].xTile?this.joinIceBlocks(s[0],s[1]):this.joinIceBlocks(s[1],s[0])}joinIceBlocks(i,t){let s=i.xTile,h=i.yTile,n=i.length+t.length+1;this.addSprite(new o(this,s,h,n,new e(i.frozen.left,t.frozen.right))),this.removeSprite(i),this.removeSprite(t)}removeIceBlock(t,e){for(let s=0;s<this.sprites.length;s++)if(this.sprites[s].id===i.ObjectIce&&this.sprites[s].yTile===e&&t>=this.sprites[s].xTile&&t<this.sprites[s].xTile+this.sprites[s].length)return void(this.sprites[s].removeBlock(t)<=0&&this.sprites.splice(s,1))}removeFire(t,e){for(let s=0;s<this.sprites.length;s++)if(this.sprites[s].yTile===e&&t===this.sprites[s].xTile&&this.sprites[s].id===i.ObjectFire)return void this.sprites.splice(s,1)}addSprite(i){this.sprites.push(i)}removeSprite(i){for(let t=0;t<this.sprites.length;t++)if(this.sprites[t]===i)return this.sprites.splice(t,1),!0;return!1}addSparks(i,t,e,s,h){this.sfxs.push(new p(this,i,t,e,s,h))}spriteTypeAt(t,e,s){if(s=void 0===s?i.ObjectOut:s,t<0||e<0||t>this.map.width||e>this.map.height)return i.ObjectOut;if(this.map.map[e][t])return this.map.map[e][t];for(let i=0;i<this.sprites.length;i++)if(this.sprites[i].isSpriteAt(t,e)&&this.sprites[i].id!==s)return this.sprites[i].id;return i.ObjectBackground}spriteAt(i,t){if(!this.map.map[t][i])for(let e=0;e<this.sprites.length;e++)if(this.sprites[e].isSpriteAt(i,t))return this.sprites[e];return null}}class T{constructor(t,e){this.time=performance.now(),this.engine=new f(t,e),this.levels=v,this.state=i.GameStatePlay,this.engine.sound.soundtrack(),this.gameLoop=this.gameLoop_.bind(this),setInterval((()=>this.gameLoop()),1e3/60)}gameLoop_(){this.engine.draw(),this.engine.move()}createIntro(){this.intro=new h(null,this.engine,"img_intro",0,0,544,416,0,0,0,0,!1),this.start=new h(null,this.engine,"img_start",7,11,140,26,-10,0,0,1,!0),this.start.animDelay=20*i.AnimDefaultDelay}}class S{constructor(){this.definitions=[],this.resources={},this.loaded=0,this.canvas=document.getElementById("canvas"),canvas&&(this.ctx=this.canvas.getContext("2d"))}add(i,t,e){this.definitions.push({type:i,name:t,src:e})}get(i){return this.resources[i]}check(i){this.ctx&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#fff",this.ctx.fillRect(50,250,450*this.loaded/this.definitions.length,40)),this.loaded===this.definitions.length&&i()}ready(i){for(const t of this.definitions){if("image"===t.type){const e=new Image;e.addEventListener("load",(()=>{this.loaded+=1,this.check(i)})),e.src=t.src,this.resources[t.name]=e}if("audio"===t.type){const e=document.getElementById(t.name);this.loaded+=1,this.resources[t.name]=e,this.check(i)}}}}async function w(){const t=document.getElementById("loader");t.style.display="none",t.style.opacity=0,function(i){let t=document.getElementById("canvas"),e=new T(t,i);window.game=e,document.querySelectorAll("button.lvl").forEach((i=>{i.addEventListener("click",A)})),document.getElementById("level-selector").style.opacity=1}(await async function(){let i;const t=new Promise((t=>i=t)),e=new S;return e.add("image","tilemap","images/tilemap.png"),e.add("image","img_ice","images/ice.png"),e.add("image","img_jar","images/jar.png"),e.add("image","img_fire","images/fire.png"),e.add("image","img_dona","images/dona.png"),e.add("image","img_intro","images/intro.png"),e.add("image","img_metal","images/metal.png"),e.add("image","img_teleport","images/teleport.png"),e.add("image","frost","images/frozen.png"),e.add("audio","sfx-ice-push","sounds/sfx-ice-push.mp3"),e.add("audio","sfx-fire-off","sounds/sfx-fire-off.mp3"),e.add("audio","sfx-falling","sounds/sfx-falling.mp3"),e.add("audio","sfx-new-ice","sounds/sfx-new-ice.mp3"),e.add("audio","sfx-climb","sounds/sfx-climb.mp3"),e.add("audio","sfx-ice-collision","sounds/sfx-ice-collision.mp3"),e.add("audio","sfx-stage-enter","sounds/sfx-stage-enter.mp3"),e.add("audio","sfx-danger","sounds/sfx-danger.mp3"),e.add("audio","sfx-ice-remove","sounds/sfx-ice-remove.mp3"),e.add("audio","sfx-state-leave","sounds/sfx-state-leave.mp3"),e.add("audio","sfx-disabled","sounds/sfx-disabled.mp3"),e.add("audio","sfx-fall","sounds/sfx-fall.mp3"),e.add("audio","sfx-music-sparks","music/sparks.mp3"),e.ready((()=>{i(e)})),t}()),window.FIRENICE_EDITOR_MODE&&(game.engine.sound.musicOn=!1,game.engine.sound.soundOn=!1,game.state=i.GameStatePlay,game.engine.editor=!0,game.engine.keyboard.intro=!1,game.engine.sound.music.pause(),canvas.addEventListener("click",(t=>{const e=Math.floor(t.offsetX/32),s=Math.floor(t.offsetY/32);if(tool<2)game.engine.map.map[s][e]=tool;else switch(tool){case i.ObjectPlayer:game.engine.player.x=32*e,game.engine.player.y=32*s;break;case i.ObjectIce:game.engine.addIceBlock(e,s);break;case i.ObjectMetal:game.engine.addSprite(new a(game.engine,e,s,1));break;case i.ObjectFire:game.engine.addSprite(new r(game.engine,e,s));break;case i.ObjectJar:game.engine.addSprite(new l(game.engine,e,s));break;case i.ObjectTeleport:game.engine.addSprite(new y(game.engine,e,s))}})),document.getElementById("theme-selector").addEventListener("change",(i=>{game.engine.map.theme=parseInt(i.target.value,10),i.target.blur()})),document.getElementById("btn-save").addEventListener("click",(()=>{document.getElementById("txt-level").value=JSON.stringify(game.engine.scene.save())}))),window.firenice=!0}function A(i){let t=i.target.getAttribute("lvl");game.engine.level=parseInt(t,10),game.engine.scene.load(game.engine.level)}window.addEventListener("load",(async()=>{window.FIRENICE_EDITOR_MODE&&w(),loader.addEventListener("click",(()=>w()))}))})();